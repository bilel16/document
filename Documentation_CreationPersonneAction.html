<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentation - CreationPersonneAction.java</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        h2 {
            color: #2c3e50;
            border-left: 5px solid #3498db;
            padding-left: 15px;
            margin: 30px 0 20px 0;
            font-size: 1.8em;
        }

        h3 {
            color: #34495e;
            margin: 25px 0 15px 0;
            font-size: 1.4em;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 10px;
        }

        h4 {
            color: #16a085;
            margin: 20px 0 10px 0;
            font-size: 1.2em;
        }

        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.3);
        }

        .code-block .keyword {
            color: #e74c3c;
            font-weight: bold;
        }

        .code-block .string {
            color: #2ecc71;
        }

        .code-block .comment {
            color: #95a5a6;
            font-style: italic;
        }

        .method-card {
            background: white;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .method-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }

        .method-title {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 5px;
            font-size: 1.3em;
            margin-bottom: 15px;
        }

        ul, ol {
            margin: 15px 0 15px 30px;
        }

        li {
            margin: 10px 0;
            line-height: 1.8;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        th {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #ecf0f1;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .flow-diagram {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 30px;
            border-radius: 10px;
            margin: 25px 0;
            text-align: center;
            font-family: monospace;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .flow-step {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 5px solid #3498db;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .arrow {
            color: #e74c3c;
            font-size: 2em;
            margin: 10px 0;
        }

        .tag {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            margin: 5px;
        }

        .tag.warning {
            background: #e74c3c;
        }

        .tag.success {
            background: #27ae60;
        }

        .tag.info {
            background: #f39c12;
        }

        footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 40px;
        }

        .highlight {
            background: #fff3cd;
            padding: 2px 8px;
            border-radius: 3px;
            font-weight: bold;
        }

        .variable {
            color: #e74c3c;
            font-weight: bold;
        }

        @media print {
            body {
                background: white;
            }

            .container {
                box-shadow: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìÑ Documentation Technique</h1>
            <p>CreationPersonneAction.java</p>
            <p style="font-size: 0.9em; margin-top: 10px; opacity: 0.8;">Application SMILE - BNA</p>
        </header>

        <div class="content">
            <!-- INTRODUCTION -->
            <section>
                <h2>üéØ Introduction</h2>
                <div class="info-box">
                    <p><strong>Classe :</strong> <code>CreationPersonneAction</code></p>
                    <p><strong>Package :</strong> <code>com.bna.smile.web.commun.actions</code></p>
                    <p><strong>Type :</strong> Action Struts (DispatchAction)</p>
                    <p><strong>R√¥le :</strong> Gestion de la cr√©ation de nouvelles personnes (physiques ou morales) dans le syst√®me bancaire SMILE.</p>
                </div>

                <div class="success-box">
                    <h4>‚úÖ Objectif Principal</h4>
                    <p>Cette classe g√®re l'ensemble du processus de cr√©ation d'une personne dans la base de donn√©es, incluant :</p>
                    <ul>
                        <li>L'initialisation des formulaires</li>
                        <li>La validation des donn√©es saisies</li>
                        <li>L'insertion dans la base de donn√©es</li>
                        <li>La gestion des pi√®ces d'identit√© et annexes</li>
                    </ul>
                </div>
            </section>

            <!-- ARCHITECTURE -->
            <section>
                <h2>üèóÔ∏è Architecture et Framework</h2>

                <h3>Pattern MVC (Struts)</h3>
                <div class="info-box">
                    <p>Cette classe fait partie du <strong>pattern MVC (Model-View-Controller)</strong> utilis√© par Struts :</p>
                    <ul>
                        <li><strong>Model :</strong> Entit√©s m√©tier (Personne, Adresse, etc.)</li>
                        <li><strong>View :</strong> Pages JSP (formulaires de cr√©ation)</li>
                        <li><strong>Controller :</strong> CreationPersonneAction (cette classe)</li>
                    </ul>
                </div>

                <h3>H√©ritage</h3>
                <div class="code-block">
<span class="keyword">public class</span> CreationPersonneAction <span class="keyword">extends</span> DispatchAction
                </div>
                <p><strong>DispatchAction</strong> permet de regrouper plusieurs m√©thodes d'action dans une seule classe au lieu d'avoir une classe par action.</p>
            </section>

            <!-- IMPORTS -->
            <section>
                <h2>üì¶ D√©pendances et Imports</h2>

                <h3>Imports Standards Java</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Package</th>
                            <th>Utilisation</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>java.io.*</code></td>
                            <td>Gestion des entr√©es/sorties</td>
                        </tr>
                        <tr>
                            <td><code>java.text.*</code></td>
                            <td>Formatage des dates (SimpleDateFormat)</td>
                        </tr>
                        <tr>
                            <td><code>java.util.*</code></td>
                            <td>Collections (Set, List, Iterator, HashSet)</td>
                        </tr>
                        <tr>
                            <td><code>java.util.regex.*</code></td>
                            <td>Validation des emails (Pattern, Matcher)</td>
                        </tr>
                        <tr>
                            <td><code>javax.servlet.*</code></td>
                            <td>API Servlet (HttpServletRequest, HttpServletResponse)</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Imports Struts</h3>
                <ul>
                    <li><code>ActionForm</code> : Formulaire de donn√©es</li>
                    <li><code>ActionForward</code> : Navigation entre pages</li>
                    <li><code>ActionMapping</code> : Configuration des mappings</li>
                    <li><code>ActionMessage</code> : Messages d'erreur/succ√®s</li>
                    <li><code>DispatchAction</code> : Classe parente</li>
                </ul>

                <h3>Imports M√©tier (BNA)</h3>
                <ul>
                    <li><code>Personne</code>, <code>Adresse</code>, <code>PieceAnnexe</code> : Entit√©s m√©tier</li>
                    <li><code>InsertPersonneCmd</code> : Commande d'insertion</li>
                    <li><code>CreationPersonneForm</code> : Formulaire de cr√©ation</li>
                    <li><code>Constants</code> : Constantes de l'application</li>
                    <li><code>DateHandler</code> : Utilitaire de gestion des dates</li>
                </ul>
            </section>

            <!-- M√âTHODES -->
            <section>
                <h2>‚öôÔ∏è M√©thodes Principales</h2>

                <!-- M√©thode 1 -->
                <div class="method-card">
                    <div class="method-title">
                        üìù 1. initierPage()
                        <span class="tag">INITIALISATION</span>
                    </div>

                    <h4>üîπ Signature</h4>
                    <div class="code-block">
<span class="keyword">public</span> ActionForward initierPage(
    ActionMapping mapping,
    ActionForm form,
    HttpServletRequest request,
    HttpServletResponse response
) <span class="keyword">throws</span> IOException, ServletException
                    </div>

                    <h4>üîπ R√¥le</h4>
                    <p>Initialise la page de cr√©ation de personne en pr√©parant le formulaire vierge.</p>

                    <h4>üîπ Flux d'ex√©cution</h4>
                    <ol>
                        <li>R√©cup√®re le formulaire <code>CreationPersonneForm</code></li>
                        <li>R√©cup√®re le param√®tre <code>indexElementAppel</code> depuis la requ√™te HTTP</li>
                        <li>R√©initialise tous les champs du formulaire (<code>clearForm()</code>)</li>
                        <li>Enregistre l'index de l'√©l√©ment appelant</li>
                        <li>Redirige vers la page <code>initierCreationPersonne</code></li>
                    </ol>

                    <h4>üîπ Param√®tres</h4>
                    <ul>
                        <li><strong>mapping</strong> : Configuration Struts pour la navigation</li>
                        <li><strong>form</strong> : Formulaire contenant les donn√©es</li>
                        <li><strong>request</strong> : Requ√™te HTTP</li>
                        <li><strong>response</strong> : R√©ponse HTTP</li>
                    </ul>

                    <h4>üîπ Gestion des erreurs</h4>
                    <div class="warning-box">
                        En cas d'exception, redirige vers la page d'erreur g√©n√©rique.
                    </div>
                </div>

                <!-- M√©thode 2 -->
                <div class="method-card">
                    <div class="method-title">
                        üöÄ 2. appelPageCreationPersonne()
                        <span class="tag info">PR√âPARATION</span>
                    </div>

                    <h4>üîπ Signature</h4>
                    <div class="code-block">
<span class="keyword">public</span> ActionForward appelPageCreationPersonne(
    ActionMapping mapping,
    ActionForm form,
    HttpServletRequest request,
    HttpServletResponse response
) <span class="keyword">throws</span> IOException, ServletException
                    </div>

                    <h4>üîπ R√¥le</h4>
                    <p>Pr√©pare le formulaire en fonction du type de pi√®ce d'identit√© √† cr√©er.</p>

                    <h4>üîπ Flux d'ex√©cution d√©taill√©</h4>

                    <div class="flow-diagram">
                        <div class="flow-step">
                            <strong>√âtape 1 :</strong> R√©initialiser le formulaire
                        </div>
                        <div class="arrow">‚Üì</div>
                        <div class="flow-step">
                            <strong>√âtape 2 :</strong> Initialiser la date du jour (format dd/MM/yyyy)
                        </div>
                        <div class="arrow">‚Üì</div>
                        <div class="flow-step">
                            <strong>√âtape 3 :</strong> R√©cup√©rer les param√®tres de la requ√™te
                            <br>‚Ä¢ typePieceCreer
                            <br>‚Ä¢ numeroPieceCreer
                        </div>
                        <div class="arrow">‚Üì</div>
                        <div class="flow-step">
                            <strong>√âtape 4 :</strong> Traitement selon le type de pi√®ce
                        </div>
                    </div>

                    <h4>üîπ Logique conditionnelle</h4>
                    <table>
                        <thead>
                            <tr>
                                <th>Type de Pi√®ce</th>
                                <th>Traitement</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Num√©ro d'ordre</strong><br>(COD_NUM_ORDRE)</td>
                                <td>
                                    ‚Ä¢ Personne sans identit√© pr√©alable<br>
                                    ‚Ä¢ R√©cup√®re l'index de l'√©l√©ment appelant<br>
                                    ‚Ä¢ D√©finit le type de pi√®ce comme COD_NUM_ORDRE
                                </td>
                            </tr>
                            <tr>
                                <td><strong>CIN</strong><br>(Carte d'Identit√© Nationale)</td>
                                <td>
                                    ‚Ä¢ Personne tunisienne physique<br>
                                    ‚Ä¢ Enregistre le type de pi√®ce (CIN)<br>
                                    ‚Ä¢ Enregistre le num√©ro de pi√®ce
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Autre</strong><br>(Passeport, etc.)</td>
                                <td>
                                    ‚Ä¢ Personne √©trang√®re<br>
                                    ‚Ä¢ Enregistre comme pi√®ce annexe<br>
                                    ‚Ä¢ Stocke type et num√©ro dans les champs annexes
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>üîπ Code Exemple</h4>
                    <div class="code-block">
<span class="comment">// Initialisation de la date du jour</span>
DateFormat myformat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"dd/MM/yyyy"</span>);
String dateDuJour = myformat.format(<span class="keyword">new</span> Date());
creationPersonneForm.setDateActuelle(dateDuJour);

<span class="comment">// Traitement pour CIN</span>
<span class="keyword">if</span> (typePieceCreer.equals(Constants.COD_CIN.toString())) {
    creationPersonneForm.setCodTypePieceClt(typePieceCreer);
    creationPersonneForm.setNumPieceClient(numeroPieceCreer);
}
                    </div>
                </div>

                <!-- M√©thode 3 - LA PLUS IMPORTANTE -->
                <div class="method-card" style="border: 3px solid #e74c3c;">
                    <div class="method-title" style="background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);">
                        üíæ 3. validerCreationPersonne() ‚≠ê M√âTHODE PRINCIPALE
                        <span class="tag warning">CRITIQUE</span>
                    </div>

                    <h4>üîπ Signature</h4>
                    <div class="code-block">
<span class="keyword">public</span> ActionForward validerCreationPersonne(
    ActionMapping mapping,
    ActionForm form,
    HttpServletRequest request,
    HttpServletResponse response
) <span class="keyword">throws</span> IOException, ServletException
                    </div>

                    <h4>üîπ R√¥le</h4>
                    <div class="success-box">
                        <p><strong>C'est la m√©thode PRINCIPALE qui effectue r√©ellement l'insertion de la personne dans la base de donn√©es.</strong></p>
                        <p>Elle orchestre l'ensemble du processus de validation et d'enregistrement.</p>
                    </div>

                    <h4>üîπ Flux d'ex√©cution complet (lignes 108-336)</h4>

                    <div class="flow-diagram">
                        <div class="flow-step" style="background: #e8f5e9;">
                            <strong>Phase 1 : INITIALISATION</strong><br>
                            Lignes 112-116
                        </div>
                        <div class="arrow">‚Üì</div>
                        <div class="flow-step" style="background: #fff3e0;">
                            <strong>Phase 2 : CONSTRUCTION DES OBJETS M√âTIER</strong><br>
                            Lignes 118-231
                        </div>
                        <div class="arrow">‚Üì</div>
                        <div class="flow-step" style="background: #e3f2fd;">
                            <strong>Phase 3 : ASSEMBLAGE DE L'ENTIT√â PERSONNE</strong><br>
                            Lignes 233-279
                        </div>
                        <div class="arrow">‚Üì</div>
                        <div class="flow-step" style="background: #fce4ec;">
                            <strong>Phase 4 : VALIDATION EMAIL</strong><br>
                            Lignes 280-291
                        </div>
                        <div class="arrow">‚Üì</div>
                        <div class="flow-step" style="background: #f3e5f5;">
                            <strong>Phase 5 : INSERTION EN BASE</strong><br>
                            Lignes 292-316
                        </div>
                        <div class="arrow">‚Üì</div>
                        <div class="flow-step" style="background: #ffebee;">
                            <strong>Phase 6 : GESTION DES ERREURS</strong><br>
                            Lignes 319-334
                        </div>
                    </div>

                    <h4>üîπ Phase 1 : Initialisation (lignes 112-116)</h4>
                    <div class="code-block">
CreationPersonneForm creationPersonneForm = (CreationPersonneForm) form;
Personne personne = <span class="keyword">new</span> Personne();
ActionMessages actionMessages = <span class="keyword">new</span> ActionMessages();
StringBuffer niveauAvancement = <span class="keyword">new</span> StringBuffer();
                    </div>
                    <ul>
                        <li><code>creationPersonneForm</code> : R√©cup√©ration du formulaire avec les donn√©es saisies</li>
                        <li><code>personne</code> : Cr√©ation d'une nouvelle instance de Personne</li>
                        <li><code>actionMessages</code> : Pour stocker les messages d'erreur</li>
                        <li><code>niveauAvancement</code> : Pour tracer le d√©roulement (debug)</li>
                    </ul>

                    <h4>üîπ Phase 2 : Construction des objets m√©tier (lignes 118-231)</h4>
                    <p>Cette phase construit tous les objets n√©cessaires √† la cr√©ation d'une personne :</p>

                    <table>
                        <thead>
                            <tr>
                                <th>Objet</th>
                                <th>Lignes</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>CategoriePersonne</strong></td>
                                <td>119-122</td>
                                <td>Physique ou Morale</td>
                            </tr>
                            <tr>
                                <td><strong>TypePiece</strong></td>
                                <td>125-128</td>
                                <td>Type de pi√®ce d'identit√© (CIN, Passeport, etc.)</td>
                            </tr>
                            <tr>
                                <td><strong>Pays (naissance)</strong></td>
                                <td>131-133</td>
                                <td>Pays de naissance</td>
                            </tr>
                            <tr>
                                <td><strong>Pays (nationalit√©)</strong></td>
                                <td>136-138</td>
                                <td>Nationalit√© de la personne</td>
                            </tr>
                            <tr>
                                <td><strong>Gouvernorat</strong></td>
                                <td>141-147</td>
                                <td>Lieu de d√©livrance de la pi√®ce</td>
                            </tr>
                            <tr>
                                <td><strong>Activite</strong></td>
                                <td>150-159</td>
                                <td>Secteur d'activit√© (Activit√©, Classe, Sous-classe)</td>
                            </tr>
                            <tr>
                                <td><strong>Profession</strong></td>
                                <td>162-171</td>
                                <td>Profession et groupe professionnel</td>
                            </tr>
                            <tr>
                                <td><strong>FormeJuridique</strong></td>
                                <td>174-178</td>
                                <td>Forme juridique (pour personnes morales)</td>
                            </tr>
                            <tr>
                                <td><strong>Adresse (r√©sidence)</strong></td>
                                <td>181-192</td>
                                <td>Adresse de r√©sidence compl√®te</td>
                            </tr>
                            <tr>
                                <td><strong>Adresse (professionnelle)</strong></td>
                                <td>195-208</td>
                                <td>Adresse professionnelle compl√®te</td>
                            </tr>
                            <tr>
                                <td><strong>PieceAnnexe</strong></td>
                                <td>211-231</td>
                                <td>Pi√®ce d'identit√© suppl√©mentaire (optionnelle)</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>üîπ Exemple : Construction de l'Activit√© (lignes 150-159)</h4>
                    <div class="code-block">
<span class="comment">// L'activit√© est un objet composite avec une cl√© compos√©e</span>
Activite activite = <span class="keyword">new</span> Activite();
ActiviteId activiteId = <span class="keyword">new</span> ActiviteId();

<span class="comment">// Remplissage de la cl√© compos√©e</span>
activiteId.setCodActAct(creationPersonneForm.getCodActiviteClt());
activiteId.setCodSactSact(<span class="keyword">new</span> Long(creationPersonneForm.getCodSclasActiviteClt()));
activiteId.setCodCactCact(creationPersonneForm.getCodClasActiviteClt());

<span class="comment">// Association de la cl√© √† l'objet</span>
activite.setActiviteId(activiteId);
                    </div>

                    <h4>üîπ Exemple : Construction de la Pi√®ce Annexe (lignes 213-230)</h4>
                    <div class="code-block">
<span class="comment">// V√©rification que tous les champs obligatoires sont remplis</span>
<span class="keyword">if</span> (!creationPersonneForm.getTypePieceAnnexe().equals(<span class="string">""</span>)
    && !creationPersonneForm.getNumPieceAnnexe().equals(<span class="string">""</span>)
    && !creationPersonneForm.getDateDellivPiann().equals(<span class="string">""</span>)
    && !creationPersonneForm.getDateFinPian().equals(<span class="string">""</span>)) {

    PieceAnnexe pieceAnnexe = <span class="keyword">new</span> PieceAnnexe();
    PieceAnnexeId pieceAnnexeId = <span class="keyword">new</span> PieceAnnexeId();

    <span class="comment">// Cl√© compos√©e</span>
    pieceAnnexeId.setCodTpceTpce(<span class="keyword">new</span> Long(creationPersonneForm.getTypePieceAnnexe()));
    pieceAnnexeId.setNumPcePian(creationPersonneForm.getNumPieceAnnexe());

    pieceAnnexe.setPieceAnnexeId(pieceAnnexeId);
    pieceAnnexe.setDatDelvPian(DateHandler.strToDate(creationPersonneForm.getDateDellivPiann()));
    pieceAnnexe.setDatFvalPian(DateHandler.strToDate(creationPersonneForm.getDateFinPian()));

    <span class="comment">// Ajout dans un Set</span>
    listPieceAnn = <span class="keyword">new</span> HashSet();
    listPieceAnn.add(pieceAnnexe);
    personne.setPieceAnnexes(listPieceAnn);
}
                    </div>

                    <h4>üîπ Phase 3 : Assemblage de l'entit√© Personne (lignes 233-279)</h4>
                    <p>Tous les objets cr√©√©s sont maintenant associ√©s √† l'entit√© Personne :</p>

                    <div class="code-block">
<span class="comment">// Pi√®ce d'identit√©</span>
personne.setTypePiece(typePiece);
personne.setNumPcePers(creationPersonneForm.getNumPieceClient());
personne.setDatDlvPers(DateHandler.strToDate(creationPersonneForm.getDateDelivClt()));

<span class="comment">// Cat√©gorie et classification</span>
personne.setCategoriePersonne(categoriePersonne);
personne.setPaysByCodNaisPays(paysNais);
personne.setPaysByCodNat1Pays(paysNat);
personne.setActivite(activite);
personne.setProfession(profession);
personne.setFormeJuridique(formeJuridique);

<span class="comment">// Informations personnelles</span>
personne.setNomNomPers(creationPersonneForm.getNomPersClt());
personne.setNomPrnPers(creationPersonneForm.getPrenomPersClt());
personne.setLibTitrPers(creationPersonneForm.getTitrePersClt());
personne.setCodSexPers(creationPersonneForm.getSexeClt());
personne.setDatNaisPers(DateHandler.strToDate(creationPersonneForm.getDateNaisClt()));
personne.setLibNaisPers(creationPersonneForm.getLieuNaisClt());
personne.setCodSitfPers(creationPersonneForm.getSitFamilialeClt());
personne.setBoolResPers(Long.valueOf(creationPersonneForm.getResidentClt()));
personne.setNomPrnpPers(creationPersonneForm.getNomPereClt());

<span class="comment">// Adresses</span>
personne.setAdresseResid(adresseResidence);
personne.setAdresseProf(adresseProfessionnelle);
personne.setGouvernorat(gouvernorat);

<span class="comment">// Informations compl√©mentaires (lignes 263-278)</span>
personne.setNomNomoPers(creationPersonneForm.getNomNomoPers());  <span class="comment">// Nom du p√®re</span>
personne.setNomPrnoPers(creationPersonneForm.getNomPrnoPers());  <span class="comment">// Pr√©nom du p√®re</span>
personne.setNomNomaPers(creationPersonneForm.getNomNomaPers());  <span class="comment">// Nom de la m√®re (arabe)</span>
personne.setNomPrnaPers(creationPersonneForm.getNomPrnaPers());  <span class="comment">// Pr√©nom de la m√®re (arabe)</span>
personne.setNomNommPers(creationPersonneForm.getNomNommPers());  <span class="comment">// Nom de la m√®re</span>
personne.setNomPrnmPers(creationPersonneForm.getNomPrnmPers());  <span class="comment">// Pr√©nom de la m√®re</span>
personne.setNumTelPers(creationPersonneForm.getNumTelPers());    <span class="comment">// T√©l√©phone</span>
personne.setNumFaxPers(creationPersonneForm.getNumFaxpers());    <span class="comment">// Fax</span>
personne.setAdrMailPers(creationPersonneForm.getAdrMailPers());  <span class="comment">// Email</span>
personne.setAdrWebPers(creationPersonneForm.getAdrWebPers());    <span class="comment">// Site web</span>
personne.setAdrSwiftPers(creationPersonneForm.getAdrSwiftPers());<span class="comment">// SWIFT</span>
personne.setAdrTlxPers(creationPersonneForm.getAdrTlxPers());    <span class="comment">// T√©lex</span>
personne.setNbrEnfPers(<span class="keyword">new</span> Long(creationPersonneForm.getNbrEnfPers())); <span class="comment">// Nombre enfants</span>
personne.setNumAffsPers(creationPersonneForm.getNumAffsPers());  <span class="comment">// N¬∞ affiliation CNSS</span>
                    </div>

                    <h4>ÔøΩÔøΩ Phase 4 : Validation de l'email (lignes 280-291)</h4>
                    <div class="warning-box">
                        <strong>‚ö†Ô∏è Validation par Expression R√©guli√®re (Regex)</strong>
                    </div>

                    <div class="code-block">
<span class="comment">// Regex pour validation d'email (RFC 5322 simplifi√©)</span>
String regex = <span class="string">"^[a-zA-Z0-9_!#$%&'*+/=?`{|}~^-]+(?:\\.[a-zA-Z0-9_!#$%&'*+/=?`{|}~^-]+)*@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$"</span>;

Pattern p = Pattern.compile(regex);
String adresseEmail = creationPersonneForm.getAdrMailPers();

<span class="keyword">if</span> (adresseEmail != <span class="keyword">null</span> && adresseEmail.length() > 0) {
    Matcher m = p.matcher(adresseEmail);
    <span class="keyword">if</span> (!m.matches()) {
        creationPersonneForm.setAlertMail(<span class="string">"invalidAdress"</span>);
    }
}
                    </div>

                    <p><strong>Explication du Regex :</strong></p>
                    <ul>
                        <li><code>^[a-zA-Z0-9_!#$%&'*+/=?`{|}~^-]+</code> : Partie locale (avant @)</li>
                        <li><code>@</code> : Le caract√®re arobase obligatoire</li>
                        <li><code>[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$</code> : Nom de domaine</li>
                    </ul>

                    <h4>üîπ Phase 5 : INSERTION EN BASE DE DONN√âES ‚≠ê (lignes 292-316)</h4>
                    <div class="success-box">
                        <strong>üéØ C'EST ICI QUE L'INSERTION SE D√âROULE !</strong>
                    </div>

                    <div class="code-block">
<span class="comment">// Si validation email r√©ussie (ou pas d'email)</span>
<span class="keyword">if</span> (creationPersonneForm.getAlertMail() == <span class="keyword">null</span> ||
    creationPersonneForm.getAlertMail().length() == 0) {

    <span class="comment">// 1. Cr√©ation de la commande d'insertion</span>
    InsertPersonneCmd insertPersonneCmd = <span class="keyword">new</span> InsertPersonneCmd();

    <span class="comment">// 2. EX√âCUTION DE L'INSERTION ‚≠ê‚≠ê‚≠ê</span>
    personne = (Personne) insertPersonneCmd.execute(personne);

    <span class="comment">// 3. V√©rification des erreurs</span>
    <span class="keyword">if</span> (personne.hasError()) {
        List listErreur = personne.getErrors();
        <span class="keyword">for</span> (Iterator it = listErreur.iterator(); it.hasNext();) {
            com.oxia.fwk.core.Error erreur = (com.oxia.fwk.core.Error) it.next();
            ActionMessage actionMessage = <span class="keyword">new</span> ActionMessage(
                <span class="string">"exception.generique"</span>, erreur.getDescription());
            actionMessages.add(<span class="string">"Erreur "</span>, actionMessage);
        }
        <span class="keyword">this</span>.saveMessages(request, actionMessages);
        <span class="keyword">return</span> mapping.findForward(<span class="string">"error"</span>);
    }

    <span class="comment">// 4. R√©cup√©ration du num√©ro de s√©quence g√©n√©r√©</span>
    String numeroSeq = request.getParameter(<span class="string">"numeroSequenceCreationPersonne"</span>);
    creationPersonneForm.setNumero(numeroSeq);
    creationPersonneForm.setNumRetour(personne.getNumSeqPers().toString());
    creationPersonneForm.setEtatInsertion(<span class="string">"I"</span>); <span class="comment">// I = Ins√©r√©</span>
}
                    </div>

                    <p><strong>D√©tails de l'insertion :</strong></p>
                    <ol>
                        <li><strong>Ligne 294 :</strong> Cr√©ation de l'objet commande <code>InsertPersonneCmd</code></li>
                        <li><strong>Ligne 295 :</strong> <span class="highlight">Appel de la m√©thode <code>execute()</code></span> qui :
                            <ul>
                                <li>R√©cup√®re une s√©quence Oracle (NUM_SEQ_PERS)</li>
                                <li>Ins√®re l'enregistrement dans la table PERSONNE</li>
                                <li>Ins√®re les pi√®ces annexes si pr√©sentes</li>
                            </ul>
                        </li>
                        <li><strong>Lignes 297-308 :</strong> Gestion des erreurs d'insertion</li>
                        <li><strong>Lignes 310-315 :</strong> R√©cup√©ration du num√©ro de s√©quence et mise √† jour du formulaire</li>
                    </ol>

                    <h4>üîπ Phase 6 : Gestion des erreurs (lignes 319-334)</h4>
                    <div class="code-block">
<span class="keyword">catch</span> (Exception e) {
    com.oxia.fwk.core.Error erreur = <span class="keyword">new</span> com.oxia.fwk.core.Error();
    StringBuffer text = <span class="keyword">new</span> StringBuffer(
        <span class="string">"la transaction est Interrompu, une erreur dans "</span> +
        <span class="string">"CreationPersonneAction / disp :validerCreationPersonne / niveau :"</span> +
        niveauAvancement.toString()
    );
    text.append(e.toString());
    erreur.setCode(<span class="string">"200"</span>);
    erreur.setDescription(text.toString());

    ActionMessage actionMessage = <span class="keyword">new</span> ActionMessage(
        <span class="string">"exception.generique"</span>, erreur.getDescription());
    actionMessages.add(<span class="string">"Erreur "</span>, actionMessage);
    <span class="keyword">this</span>.saveMessages(request, actionMessages);
    <span class="keyword">return</span> mapping.findForward(<span class="string">"error"</span>);
}
                    </div>

                    <p><strong>Le StringBuffer <code>niveauAvancement</code></strong> est crucial pour le d√©bogage car il indique exactement √† quelle √©tape l'erreur s'est produite :</p>
                    <ul>
                        <li>"categorie personnne"</li>
                        <li>"type pi√®ce"</li>
                        <li>"pays naissance"</li>
                        <li>etc.</li>
                    </ul>
                </div>

                <!-- M√©thode 4 -->
                <div class="method-card">
                    <div class="method-title">
                        üìã 4. saisirInfComplementaires()
                        <span class="tag">NAVIGATION</span>
                    </div>

                    <h4>üîπ R√¥le</h4>
                    <p>Ouvre une fen√™tre popup pour saisir les informations compl√©mentaires.</p>

                    <div class="code-block">
<span class="keyword">public</span> ActionForward saisirInfComplementaires(
    ActionMapping mapping,
    ActionForm form,
    HttpServletRequest request,
    HttpServletResponse response
) <span class="keyword">throws</span> IOException, ServletException {
    <span class="keyword">return</span> mapping.findForward(<span class="string">"popupInfComplementairesCreationPers"</span>);
}
                    </div>
                </div>

                <!-- M√©thode 5 -->
                <div class="method-card">
                    <div class="method-title">
                        üíæ 5. sauvgarderInfComplementaires()
                        <span class="tag">NAVIGATION</span>
                    </div>

                    <h4>üîπ R√¥le</h4>
                    <p>Sauvegarde les informations compl√©mentaires et retourne √† la page principale.</p>

                    <div class="code-block">
<span class="keyword">public</span> ActionForward sauvgarderInfComplementaires(
    ActionMapping mapping,
    ActionForm form,
    HttpServletRequest request,
    HttpServletResponse response
) <span class="keyword">throws</span> IOException, ServletException {
    <span class="keyword">return</span> mapping.findForward(<span class="string">"initierCreationPersonne"</span>);
}
                    </div>

                    <div class="info-box">
                        <strong>Note :</strong> Cette m√©thode semble incompl√®te dans le code actuel. Elle devrait normalement contenir la logique de sauvegarde.
                    </div>
                </div>
            </section>

            <!-- FLUX COMPLET -->
            <section>
                <h2>üîÑ Flux Complet d'Ex√©cution</h2>

                <div class="flow-diagram">
                    <div class="flow-step" style="background: #e8f5e9;">
                        <strong>1. Utilisateur acc√®de √† la page</strong><br>
                        ‚Üí <code>initierPage()</code> ou <code>appelPageCreationPersonne()</code>
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step" style="background: #e3f2fd;">
                        <strong>2. Affichage du formulaire JSP</strong><br>
                        Formulaire vierge ou pr√©-rempli
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step" style="background: #fff3e0;">
                        <strong>3. Utilisateur saisit les donn√©es</strong><br>
                        Informations personnelles, adresses, pi√®ces d'identit√©
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step" style="background: #fce4ec;">
                        <strong>4. Soumission du formulaire</strong><br>
                        ‚Üí <code>validerCreationPersonne()</code>
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step" style="background: #f3e5f5;">
                        <strong>5. Construction de l'entit√© Personne</strong><br>
                        Tous les objets m√©tier sont cr√©√©s et assembl√©s
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step" style="background: #e0f2f1;">
                        <strong>6. Validation de l'email</strong><br>
                        V√©rification par expression r√©guli√®re
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step" style="background: #ffebee; font-weight: bold;">
                        <strong>7. INSERTION EN BASE DE DONN√âES ‚≠ê</strong><br>
                        <code>InsertPersonneCmd.execute(personne)</code><br>
                        ‚Üí <code>PersonneService.insertPersonne()</code><br>
                        ‚Üí <code>InsertPersonneTrt.perform()</code><br>
                        ‚Üí <code>CRUDservice.create()</code><br>
                        ‚Üí <code>Hibernate INSERT INTO PERSONNE</code>
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step" style="background: #e8f5e9;">
                        <strong>8. Retour du num√©ro de s√©quence</strong><br>
                        NUM_SEQ_PERS g√©n√©r√© par la base
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step" style="background: #e3f2fd;">
                        <strong>9. Mise √† jour du formulaire</strong><br>
                        Affichage du message de succ√®s avec le num√©ro
                    </div>
                    <div class="arrow">‚Üì</div>
                    <div class="flow-step" style="background: #c8e6c9;">
                        <strong>10. Redirection</strong><br>
                        Retour √† la page avec confirmation
                    </div>
                </div>
            </section>

            <!-- ENTIT√âS M√âTIER -->
            <section>
                <h2>üìä Entit√©s M√©tier Utilis√©es</h2>

                <table>
                    <thead>
                        <tr>
                            <th>Entit√©</th>
                            <th>Champs Principaux</th>
                            <th>Table BD</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Personne</strong></td>
                            <td>numSeqPers, numPcePers, nomNomPers, nomPrnPers, datNaisPers</td>
                            <td>PERSONNE</td>
                        </tr>
                        <tr>
                            <td><strong>Adresse</strong></td>
                            <td>immeuble, rue, cite, ville, codPaysPays, codCpCp</td>
                            <td>ADRESSE</td>
                        </tr>
                        <tr>
                            <td><strong>CategoriePersonne</strong></td>
                            <td>codCatpCatp (P=Physique, M=Morale)</td>
                            <td>CATEGORIE_PERSONNE</td>
                        </tr>
                        <tr>
                            <td><strong>TypePiece</strong></td>
                            <td>codTpceTpce (CIN, Passeport, etc.)</td>
                            <td>TYPE_PIECE</td>
                        </tr>
                        <tr>
                            <td><strong>Pays</strong></td>
                            <td>codPaysPays</td>
                            <td>PAYS</td>
                        </tr>
                        <tr>
                            <td><strong>Gouvernorat</strong></td>
                            <td>codGouvGouv</td>
                            <td>GOUVERNORAT</td>
                        </tr>
                        <tr>
                            <td><strong>Activite</strong></td>
                            <td>codActAct, codCactCact, codSactSact</td>
                            <td>ACTIVITE</td>
                        </tr>
                        <tr>
                            <td><strong>Profession</strong></td>
                            <td>codProfProf, codGproGpro</td>
                            <td>PROFESSION</td>
                        </tr>
                        <tr>
                            <td><strong>FormeJuridique</strong></td>
                            <td>codFjFj (SARL, SA, etc.)</td>
                            <td>FORME_JURIDIQUE</td>
                        </tr>
                        <tr>
                            <td><strong>PieceAnnexe</strong></td>
                            <td>codTpceTpce, numPcePian, datDelvPian, datFvalPian</td>
                            <td>PIECE_ANNEXE</td>
                        </tr>
                    </tbody>
                </table>
            </section>

            <!-- POINTS TECHNIQUES IMPORTANTS -->
            <section>
                <h2>üîß Points Techniques Importants</h2>

                <h3>1. Cl√©s Compos√©es</h3>
                <div class="info-box">
                    <p>Plusieurs entit√©s utilisent des <strong>cl√©s compos√©es</strong> (classes *Id) :</p>
                    <ul>
                        <li><code>ActiviteId</code> : codActAct + codCactCact + codSactSact</li>
                        <li><code>ProfessionId</code> : codProfProf + codGproGpro</li>
                        <li><code>PieceAnnexeId</code> : codTpceTpce + numPcePian</li>
                    </ul>
                </div>

                <h3>2. Gestion des Dates</h3>
                <div class="code-block">
<span class="comment">// Conversion String ‚Üí Date via DateHandler</span>
personne.setDatNaisPers(
    DateHandler.strToDate(creationPersonneForm.getDateNaisClt())
);
                </div>
                <p>Le <code>DateHandler</code> est un utilitaire personnalis√© pour convertir les dates.</p>

                <h3>3. Collections (Set vs List)</h3>
                <div class="info-box">
                    <p>Utilisation de <code>HashSet</code> pour les pi√®ces annexes :</p>
                    <ul>
                        <li><strong>Set</strong> : Pas de doublons, pas d'ordre garanti</li>
                        <li>Correspondance avec le mapping Hibernate (relation one-to-many)</li>
                    </ul>
                </div>

                <h3>4. Tra√ßabilit√© avec niveauAvancement</h3>
                <div class="code-block">
StringBuffer niveauAvancement = <span class="keyword">new</span> StringBuffer();
niveauAvancement.append(<span class="string">" categorie personnne "</span>);
<span class="comment">// ... code de traitement ...</span>
niveauAvancement.append(<span class="string">" type pi√®ce "</span>);
<span class="comment">// ... etc ...</span>
                </div>
                <p>Permet de savoir exactement o√π une erreur s'est produite.</p>

                <h3>5. Pattern Commande (Command Pattern)</h3>
                <div class="success-box">
                    <p><strong>InsertPersonneCmd</strong> encapsule la logique d'insertion :</p>
                    <ul>
                        <li>S√©paration des responsabilit√©s</li>
                        <li>R√©utilisabilit√©</li>
                        <li>Testabilit√©</li>
                    </ul>
                </div>

                <h3>6. Validation Email (Regex)</h3>
                <div class="warning-box">
                    <p><strong>Expression R√©guli√®re utilis√©e :</strong></p>
                    <code>^[a-zA-Z0-9_!#$%&'*+/=?`{|}~^-]+(?:\\.[a-zA-Z0-9_!#$%&'*+/=?`{|}~^-]+)*@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$</code>
                    <p style="margin-top: 10px;">Cette regex est conforme au standard RFC 5322 (simplifi√©)</p>
                </div>
            </section>

            <!-- SC√âNARIOS D'UTILISATION -->
            <section>
                <h2>üìñ Sc√©narios d'Utilisation</h2>

                <div class="method-card">
                    <div class="method-title">
                        Sc√©nario 1 : Cr√©ation d'une Personne Tunisienne
                        <span class="tag success">CIN</span>
                    </div>
                    <ol>
                        <li>L'utilisateur clique sur "Nouvelle Personne"</li>
                        <li>S√©lection du type de pi√®ce : <strong>CIN</strong></li>
                        <li>Saisie du num√©ro de CIN (ex: 12345678)</li>
                        <li>Appel de <code>appelPageCreationPersonne()</code> avec typePieceCreer=CIN</li>
                        <li>Le formulaire se pr√©-remplit avec le num√©ro de CIN</li>
                        <li>L'utilisateur compl√®te les informations</li>
                        <li>Soumission ‚Üí <code>validerCreationPersonne()</code></li>
                        <li>Insertion en base avec NUM_SEQ_PERS auto-g√©n√©r√©</li>
                    </ol>
                </div>

                <div class="method-card">
                    <div class="method-title">
                        Sc√©nario 2 : Cr√©ation d'une Personne √âtrang√®re
                        <span class="tag info">PASSEPORT</span>
                    </div>
                    <ol>
                        <li>S√©lection du type de pi√®ce : <strong>Passeport</strong></li>
                        <li>Saisie du num√©ro de passeport</li>
                        <li>Le syst√®me cr√©e une <strong>PieceAnnexe</strong> au lieu d'une pi√®ce principale</li>
                        <li>Les champs suivants sont obligatoires :
                            <ul>
                                <li>Type de pi√®ce annexe</li>
                                <li>Num√©ro de pi√®ce annexe</li>
                                <li>Date de d√©livrance</li>
                                <li>Date de fin de validit√©</li>
                            </ul>
                        </li>
                        <li>Insertion de la personne avec pi√®ce annexe associ√©e</li>
                    </ol>
                </div>

                <div class="method-card">
                    <div class="method-title">
                        Sc√©nario 3 : Cr√©ation avec Num√©ro d'Ordre
                        <span class="tag warning">COD_NUM_ORDRE</span>
                    </div>
                    <ol>
                        <li>Cas d'une personne sans pi√®ce d'identit√© pr√©alable</li>
                        <li>Le syst√®me g√©n√®re un num√©ro d'ordre temporaire</li>
                        <li>Type de pi√®ce = COD_NUM_ORDRE</li>
                        <li>Ce num√©ro pourra √™tre remplac√© ult√©rieurement par une vraie pi√®ce</li>
                    </ol>
                </div>
            </section>

            <!-- GESTION DES ERREURS -->
            <section>
                <h2>‚ö†Ô∏è Gestion des Erreurs</h2>

                <h3>Types d'Erreurs G√©r√©es</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Type d'Erreur</th>
                            <th>Gestion</th>
                            <th>Message</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Email invalide</strong></td>
                            <td>Validation regex</td>
                            <td>setAlertMail("invalidAdress")</td>
                        </tr>
                        <tr>
                            <td><strong>Erreur d'insertion</strong></td>
                            <td>personne.hasError()</td>
                            <td>Liste des erreurs m√©tier</td>
                        </tr>
                        <tr>
                            <td><strong>Exception technique</strong></td>
                            <td>Bloc catch global</td>
                            <td>Niveau d'avancement + d√©tails exception</td>
                        </tr>
                        <tr>
                            <td><strong>Donn√©es manquantes</strong></td>
                            <td>Validation Struts</td>
                            <td>Messages de validation</td>
                        </tr>
                    </tbody>
                </table>

                <h3>M√©canisme de Tra√ßabilit√©</h3>
                <div class="code-block">
StringBuffer niveauAvancement = <span class="keyword">new</span> StringBuffer();

<span class="comment">// √Ä chaque √©tape</span>
niveauAvancement.append(<span class="string">" categorie personnne "</span>);
<span class="comment">// ... traitement ...</span>

<span class="comment">// En cas d'erreur</span>
<span class="keyword">catch</span> (Exception e) {
    text.append(<span class="string">"niveau :"</span> + niveauAvancement.toString());
    <span class="comment">// Permet de savoir exactement o√π l'erreur s'est produite</span>
}
                </div>
            </section>

            <!-- POINTS D'AM√âLIORATION -->
            <section>
                <h2>üí° Points d'Am√©lioration Potentiels</h2>

                <div class="warning-box">
                    <h4>1. S√©paration des responsabilit√©s</h4>
                    <p>La m√©thode <code>validerCreationPersonne()</code> est tr√®s longue (228 lignes). Elle pourrait √™tre refactoris√©e en sous-m√©thodes :</p>
                    <ul>
                        <li><code>construireEntitesReferentielles()</code></li>
                        <li><code>construireAdresses()</code></li>
                        <li><code>construirePieceAnnexe()</code></li>
                        <li><code>assemblerPersonne()</code></li>
                    </ul>
                </div>

                <div class="warning-box">
                    <h4>2. Validation</h4>
                    <p>La validation de l'email pourrait √™tre d√©plac√©e dans le formulaire (validation c√¥t√© client) ou dans un validateur Struts.</p>
                </div>

                <div class="warning-box">
                    <h4>3. Gestion des transactions</h4>
                    <p>La gestion transactionnelle est d√©l√©gu√©e √† la commande, mais pourrait √™tre explicitement visible au niveau de l'action.</p>
                </div>

                <div class="warning-box">
                    <h4>4. Internationalisation</h4>
                    <p>Les messages d'erreur en dur pourraient √™tre externalis√©s dans des fichiers de ressources.</p>
                </div>

                <div class="warning-box">
                    <h4>5. M√©thode sauvgarderInfComplementaires()</h4>
                    <p>Cette m√©thode semble vide et ne contient pas de logique de sauvegarde effective.</p>
                </div>
            </section>

            <!-- CONCLUSION -->
            <section>
                <h2>‚úÖ Conclusion</h2>

                <div class="success-box">
                    <h4>R√©sum√© des Responsabilit√©s</h4>
                    <p><strong>CreationPersonneAction</strong> est le contr√¥leur central pour la cr√©ation de personnes dans SMILE. Il orchestre :</p>
                    <ol>
                        <li>L'initialisation des formulaires</li>
                        <li>La pr√©paration des donn√©es selon le type de pi√®ce</li>
                        <li>La validation des donn√©es saisies</li>
                        <li>La construction des objets m√©tier</li>
                        <li>L'appel √† la couche de persistance</li>
                        <li>La gestion des erreurs et retours utilisateur</li>
                    </ol>
                </div>

                <div class="info-box">
                    <h4>Flux de Donn√©es Principal</h4>
                    <p style="text-align: center; font-family: monospace; font-size: 1.1em; line-height: 2;">
                        <strong>JSP</strong> ‚Üí <strong>CreationPersonneAction</strong> ‚Üí <strong>InsertPersonneCmd</strong> ‚Üí
                        <strong>PersonneService</strong> ‚Üí <strong>InsertPersonneTrt</strong> ‚Üí
                        <strong>PersonneDAO</strong> ‚Üí <strong>CRUDservice</strong> ‚Üí <strong>Hibernate</strong> ‚Üí <strong>Oracle DB</strong>
                    </p>
                </div>

                <div class="success-box" style="text-align: center; padding: 30px;">
                    <h3 style="color: #27ae60; margin-bottom: 15px;">üéØ Point Cl√© √† Retenir</h3>
                    <p style="font-size: 1.2em; line-height: 1.8;">
                        L'insertion r√©elle dans la table <strong>PERSONNE</strong> se fait √† la <strong>ligne 295</strong> :<br>
                        <code style="background: #2c3e50; color: #ecf0f1; padding: 10px 20px; border-radius: 5px; display: inline-block; margin-top: 10px;">
                            personne = (Personne) insertPersonneCmd.execute(personne);
                        </code>
                    </p>
                </div>
            </section>
        </div>

        <footer>
            <p>Documentation g√©n√©r√©e pour le projet SMILE - BNA</p>
            <p style="font-size: 0.9em; margin-top: 10px;">CreationPersonneAction.java - Version d'analyse 2026</p>
        </footer>
    </div>
</body>
</html>