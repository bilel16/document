<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapport Technique - Module Virement Central BNA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .meta-info {
            background: #f8f9fa;
            padding: 20px 40px;
            border-bottom: 3px solid #1e3c72;
        }

        .meta-info table {
            width: 100%;
        }

        .meta-info td {
            padding: 8px;
        }

        .meta-info td:first-child {
            font-weight: bold;
            width: 200px;
            color: #1e3c72;
        }

        .content {
            padding: 40px;
        }

        .section {
            margin-bottom: 40px;
        }

        h2 {
            color: #1e3c72;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #1e3c72;
        }

        h3 {
            color: #2a5298;
            font-size: 1.5em;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        h4 {
            color: #4a7298;
            font-size: 1.2em;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .toc {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 8px;
            margin-bottom: 40px;
        }

        .toc h2 {
            border: none;
            margin-bottom: 20px;
        }

        .toc ul {
            list-style: none;
        }

        .toc ul li {
            padding: 8px 0;
            border-bottom: 1px solid #ddd;
        }

        .toc ul li:last-child {
            border-bottom: none;
        }

        .toc a {
            color: #1e3c72;
            text-decoration: none;
            display: block;
            padding: 5px 10px;
            transition: all 0.3s;
        }

        .toc a:hover {
            background: #1e3c72;
            color: white;
            padding-left: 20px;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .success-box {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        th {
            background: #1e3c72;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
        }

        tr:hover {
            background: #f5f5f5;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #c7254e;
        }

        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
        }

        pre code {
            background: none;
            color: #f8f8f2;
            padding: 0;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: bold;
            margin: 2px;
        }

        .badge-primary {
            background: #1e3c72;
            color: white;
        }

        .badge-success {
            background: #4caf50;
            color: white;
        }

        .badge-warning {
            background: #ff9800;
            color: white;
        }

        .badge-danger {
            background: #f44336;
            color: white;
        }

        .badge-info {
            background: #2196F3;
            color: white;
        }

        ul, ol {
            margin: 15px 0;
            padding-left: 30px;
        }

        li {
            margin: 8px 0;
        }

        .footer {
            background: #1e3c72;
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 40px;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
            }

            .toc a:hover {
                background: transparent;
                color: #1e3c72;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š Rapport Technique DÃ©taillÃ©</h1>
            <p>Module de Virement Central - Mandat BCT</p>
            <p>SystÃ¨me SMILE - Banque Nationale Agricole (BNA)</p>
        </div>

        <div class="meta-info">
            <table>
                <tr>
                    <td>ğŸ“… Date de gÃ©nÃ©ration :</td>
                    <td><script>document.write(new Date().toLocaleDateString('fr-FR', {weekday: 'long', year: 'numeric', month: 'long', day: 'numeric'}));</script></td>
                </tr>
                <tr>
                    <td>ğŸ“ ContrÃ´leur :</td>
                    <td><code>PecVirementCentralCtr.java</code></td>
                </tr>
                <tr>
                    <td>ğŸ“¦ Package :</td>
                    <td><code>com.bna.smile.web.virement.controller</code></td>
                </tr>
                <tr>
                    <td>ğŸ”¢ Lignes de code :</td>
                    <td>3261 lignes</td>
                </tr>
                <tr>
                    <td>ğŸ—ï¸ Architecture :</td>
                    <td>JSF 1.2 + RichFaces + Spring</td>
                </tr>
            </table>
        </div>

        <div class="content">
            <div class="toc">
                <h2>ğŸ“‘ Table des MatiÃ¨res</h2>
                <ul>
                    <li><a href="#section1">1. Vue d'ensemble du module</a></li>
                    <li><a href="#section2">2. Architecture technique</a></li>
                    <li><a href="#section3">3. FonctionnalitÃ©s principales</a></li>
                    <li><a href="#section4">4. Structure du contrÃ´leur</a></li>
                    <li><a href="#section5">5. Flux de traitement</a></li>
                    <li><a href="#section6">6. ModÃ¨les de donnÃ©es</a></li>
                    <li><a href="#section7">7. Validation et sÃ©curitÃ©</a></li>
                    <li><a href="#section8">8. Interfaces JSF</a></li>
                    <li><a href="#section9">9. Points d'amÃ©lioration</a></li>
                    <li><a href="#section10">10. Recommandations</a></li>
                </ul>
            </div>

            <div id="section1" class="section">
                <h2>1. Vue d'ensemble du module</h2>

                <h3>1.1 Objectif</h3>
                <p>Le module <strong>Virement Central - Mandat BCT</strong> est un composant essentiel du systÃ¨me SMILE de la Banque Nationale Agricole. Il permet la gestion complÃ¨te des virements effectuÃ©s via des mandats reÃ§us de la Banque Centrale de Tunisie (BCT).</p>

                <div class="info-box">
                    <h4>ğŸ’¡ Contexte mÃ©tier</h4>
                    <p>Ce module traite les ordres de virement centralisÃ©s Ã©manant de la BCT, permettant aux agences bancaires de :</p>
                    <ul>
                        <li>CrÃ©er des ordres de virement avec plusieurs bÃ©nÃ©ficiaires (jusqu'Ã  10)</li>
                        <li>Consulter et modifier les ordres existants</li>
                        <li>ExÃ©cuter les virements aprÃ¨s validation</li>
                        <li>GÃ©nÃ©rer des documents de dÃ©charge</li>
                    </ul>
                </div>

                <h3>1.2 CaractÃ©ristiques principales</h3>
                <table>
                    <tr>
                        <th>CaractÃ©ristique</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><strong>Type de module</strong></td>
                        <td>ContrÃ´leur JSF avec portÃ©e Session</td>
                    </tr>
                    <tr>
                        <td><strong>BÃ©nÃ©ficiaires max</strong></td>
                        <td>10 par ordre de virement</td>
                    </tr>
                    <tr>
                        <td><strong>Validation RIB</strong></td>
                        <td>ContrÃ´le intÃ©gritÃ© (20 chiffres) + VÃ©rification base de donnÃ©es</td>
                    </tr>
                    <tr>
                        <td><strong>Ã‰tats d'ordre</strong></td>
                        <td>En Attente (A), ExÃ©cutÃ© (E), RejetÃ© (R)</td>
                    </tr>
                    <tr>
                        <td><strong>Rapports</strong></td>
                        <td>GÃ©nÃ©ration PDF via JasperReports</td>
                    </tr>
                    <tr>
                        <td><strong>SÃ©curitÃ©</strong></td>
                        <td>Validation multi-niveaux + ContrÃ´le des comptes en devises</td>
                    </tr>
                </table>

                <h3>1.3 Acteurs et cas d'utilisation</h3>

                <h4>Acteurs</h4>
                <ul>
                    <li><strong>OpÃ©rateur d'agence</strong> : Saisie et validation des ordres de virement</li>
                    <li><strong>Responsable</strong> : Consultation et exÃ©cution des ordres</li>
                    <li><strong>SystÃ¨me BCT</strong> : Source des mandats de virement</li>
                    <li><strong>SystÃ¨me central BNA</strong> : Traitement et exÃ©cution des virements</li>
                </ul>

                <h4>Cas d'utilisation principaux</h4>
                <ol>
                    <li><strong>CrÃ©er un ordre de virement</strong>
                        <ul>
                            <li>Saisir le compte dÃ©biteur (compte interne mandat)</li>
                            <li>Ajouter jusqu'Ã  10 bÃ©nÃ©ficiaires avec RIB, nom et montant</li>
                            <li>Valider l'ordre et gÃ©nÃ©rer une dÃ©charge PDF</li>
                        </ul>
                    </li>
                    <li><strong>Consulter les ordres</strong>
                        <ul>
                            <li>Rechercher par numÃ©ro de remise</li>
                            <li>Filtrer par Ã©tat (Attente/ExÃ©cutÃ©/RejetÃ©)</li>
                            <li>Visualiser tous les ordres</li>
                        </ul>
                    </li>
                    <li><strong>Modifier un ordre</strong>
                        <ul>
                            <li>Ã‰diter les bÃ©nÃ©ficiaires</li>
                            <li>Modifier la date d'exÃ©cution</li>
                            <li>Supprimer des bÃ©nÃ©ficiaires</li>
                        </ul>
                    </li>
                    <li><strong>ExÃ©cuter un ordre</strong>
                        <ul>
                            <li>Lancer l'exÃ©cution du virement</li>
                            <li>Mise Ã  jour automatique des Ã©tats</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <div id="section2" class="section">
                <h2>2. Architecture technique</h2>

                <h3>2.1 Stack technologique</h3>
                <table>
                    <tr>
                        <th>Composant</th>
                        <th>Technologie</th>
                        <th>Version/Framework</th>
                    </tr>
                    <tr>
                        <td>Framework Web</td>
                        <td>JavaServer Faces (JSF)</td>
                        <td>JSF 1.2</td>
                    </tr>
                    <tr>
                        <td>Composants UI</td>
                        <td>RichFaces</td>
                        <td>Ajax4JSF + Rich Components</td>
                    </tr>
                    <tr>
                        <td>Injection de dÃ©pendances</td>
                        <td>Spring Framework</td>
                        <td>Configuration XML</td>
                    </tr>
                    <tr>
                        <td>Persistance</td>
                        <td>Hibernate / JPA</td>
                        <td>Via SearchEngine personnalisÃ©</td>
                    </tr>
                    <tr>
                        <td>Reporting</td>
                        <td>JasperReports</td>
                        <td>GÃ©nÃ©ration PDF</td>
                    </tr>
                    <tr>
                        <td>Logging</td>
                        <td>Log4j</td>
                        <td>Apache Log4j</td>
                    </tr>
                    <tr>
                        <td>Serveur d'application</td>
                        <td>J2EE Container</td>
                        <td>Compatible Servlet 2.5+</td>
                    </tr>
                </table>

                <h3>2.2 Architecture en couches</h3>

                <div class="info-box">
                    <h4>ğŸ“ ModÃ¨le MVC Ã©tendu</h4>
                    <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COUCHE PRÃ‰SENTATION                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  JSF Views (XHTML)                           â”‚  â”‚
â”‚  â”‚  - pecVirementMandatBct.xhtml                â”‚  â”‚
â”‚  â”‚  - consultationpecVirementMandatBct.xhtml    â”‚  â”‚
â”‚  â”‚  - modificationBeneficiaire...xhtml          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COUCHE CONTRÃ”LEUR                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PecVirementCentralCtr.java                  â”‚  â”‚
â”‚  â”‚  - Managed Bean (Session Scope)              â”‚  â”‚
â”‚  â”‚  - Gestion Ã©tat UI                           â”‚  â”‚
â”‚  â”‚  - Orchestration des appels                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COUCHE COMMANDE                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  VirementCmd.java                            â”‚  â”‚
â”‚  â”‚  - Pattern Command                           â”‚  â”‚
â”‚  â”‚  - DÃ©lÃ©gation vers services                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COUCHE SERVICE                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  IVirementService                            â”‚  â”‚
â”‚  â”‚  - Logique mÃ©tier                            â”‚  â”‚
â”‚  â”‚  - Transactions                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COUCHE DONNÃ‰ES                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ModÃ¨les JPA                                 â”‚  â”‚
â”‚  â”‚  - OrdreVirement                             â”‚  â”‚
â”‚  â”‚  - BeneficiaireOrdreVirement                 â”‚  â”‚
â”‚  â”‚  - ContratCpt                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  SearchEngine / CRUDService                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BASE DE DONNÃ‰ES                        â”‚
â”‚              (Oracle / SQL Server)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
                </div>

                <h3>2.3 DÃ©pendances principales</h3>

<h4>Imports du contrÃ´leur</h4>
                <pre><code>// Java Standard
import java.io.Serializable;
import java.math.BigInteger;
import java.sql.Connection;
import java.text.SimpleDateFormat;
import java.util.*;

// JSF & Servlet
import javax.faces.application.FacesMessage;
import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import javax.servlet.http.HttpServletRequest;

// Ajax4JSF
import org.ajax4jsf.model.KeepAlive;

// Logging
import org.apache.log4j.Logger;

// ModÃ¨les mÃ©tier BNA
import com.bna.commun.model.*;
import com.bna.smile.model.virement.commande.VirementCmd;
import com.bna.smile.model.virement.model.VirementVo;

// Framework OXIA
import com.oxia.fwk.context.Context;
import com.oxia.fwk.core.*;
</code></pre>

                <h3>2.4 Configuration Spring</h3>

                <h4>faces-config.xml</h4>
                <pre><code>&lt;managed-bean&gt;
    &lt;managed-bean-name&gt;pecVirementCentralCtr&lt;/managed-bean-name&gt;
    &lt;managed-bean-class&gt;
        com.bna.smile.web.virement.controller.PecVirementCentralCtr
    &lt;/managed-bean-class&gt;
    &lt;managed-bean-scope&gt;session&lt;/managed-bean-scope&gt;
&lt;/managed-bean&gt;</code></pre>

                <div class="warning-box">
                    <h4>âš ï¸ Note importante</h4>
                    <p><strong>Session Scope</strong> : Le bean est maintenu durant toute la session utilisateur. Cela permet de conserver l'Ã©tat entre les requÃªtes mais augmente la consommation mÃ©moire du serveur.</p>
                </div>
            </div>

            <div id="section3" class="section">
                <h2>3. FonctionnalitÃ©s principales</h2>

                <h3>3.1 CrÃ©ation d'ordre de virement</h3>

                <h4>MÃ©thode : <code>validerVirementMandatBct()</code></h4>

                <div class="success-box">
                    <p><strong>Objectif :</strong> Valider et enregistrer un ordre de virement avec ses bÃ©nÃ©ficiaires</p>
                </div>

                <p><strong>Ã‰tapes du traitement :</strong></p>
                <ol>
                    <li><strong>GÃ©nÃ©ration du numÃ©ro de remise</strong>
                        <ul>
                            <li>RÃ©cupÃ©ration de la sÃ©quence globale via <code>getSeqAgence()</code></li>
                            <li>Format : <code>[CodeAgence][AnnÃ©e][SÃ©quence]</code></li>
                            <li>Exemple : <code>00820250001</code></li>
                        </ul>
                    </li>
                    <li><strong>Construction de l'ordre</strong>
                        <ul>
                            <li>CrÃ©ation d'un objet <code>OrdreVirement</code></li>
                            <li>Association avec la structure initiatrice</li>
                            <li>DÃ©finition du personnel validateur</li>
                            <li>Ã‰tat initial : "A" (En Attente)</li>
                        </ul>
                    </li>
                    <li><strong>Validation des bÃ©nÃ©ficiaires</strong>
                        <ul>
                            <li>VÃ©rification de la liste (max 10)</li>
                            <li>ContrÃ´le des RIB</li>
                            <li>Validation des montants</li>
                        </ul>
                    </li>
                    <li><strong>Appel au service</strong>
                        <ul>
                            <li><code>VirementCmd.validerVirementCentralVirement()</code></li>
                            <li>Transaction en base de donnÃ©es</li>
                        </ul>
                    </li>
                    <li><strong>GÃ©nÃ©ration du PDF</strong>
                        <ul>
                            <li>PrÃ©paration des paramÃ¨tres Jasper</li>
                            <li>Appel Ã  <code>imprimerVirementMandatBct()</code></li>
                        </ul>
                    </li>
                </ol>

                <h4>Code simplifiÃ© :</h4>
                <pre><code>public void validerVirementMandatBct() {
    try {
        // 1. GÃ©nÃ©ration numÃ©ro de remise
        Long seqGlobVir = getSeqAgence(virementVo);
        String numeroRemise = formatNumeroRemise(seqGlobVir);

        // 2. Construction ordre
        OrdreVirement ordreVirement = new OrdreVirement();
        ordreVirement.setNumOvirOvir(numeroRemise);
        ordreVirement.setCodEtatOvir("A");
        ordreVirement.setListeBeneficiaires(listeBeneficiaires);

        // 3. Validation
        virementVo = virementCmd.validerVirementCentral(virementVo);

        if (virementVo.isStadeEnregistrement()) {
            setStrEtatValidationTrt("1");
            imprimerVirementMandatBct();
            etatCmdValiderVirement = false; // DÃ©sactiver le bouton
        }
    } catch (Exception e) {
        setStrEtatValidationTrt("2");
        messageValidation = e.getMessage();
    }
}</code></pre>

                <h3>3.2 Ajout de bÃ©nÃ©ficiaires</h3>

                <h4>MÃ©thode : <code>ajouterBeneficiaireVirement()</code></h4>

                <table>
                    <tr>
                        <th>Validation</th>
                        <th>ContrÃ´le effectuÃ©</th>
                    </tr>
                    <tr>
                        <td><span class="badge badge-primary">Limite max</span></td>
                        <td>VÃ©rification â‰¤ 10 bÃ©nÃ©ficiaires</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-primary">RIB</span></td>
                        <td>20 caractÃ¨res numÃ©riques</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-primary">Montant</span></td>
                        <td>Montant &gt; 0</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-primary">Compte valide</span></td>
                        <td>msgValidatorCompte.length &lt; 1</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-primary">Nom</span></td>
                        <td>Max 60 caractÃ¨res (tronquÃ© si dÃ©passÃ©)</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-primary">Motif</span></td>
                        <td>Max 200 caractÃ¨res (tronquÃ© si dÃ©passÃ©)</td>
                    </tr>
                </table>

                <h3>3.3 Validation RIB</h3>

                <h4>MÃ©thode : <code>verifierCompte()</code></h4>

                <p>Cette mÃ©thode effectue une validation complexe en plusieurs Ã©tapes :</p>

                <div class="info-box">
                    <h4>ğŸ” Processus de validation RIB</h4>
                    <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Format de saisie                        â”‚
â”‚     - 13 chiffres (compte BNA simplifiÃ©)    â”‚
â”‚     - 20 chiffres (RIB complet)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Conversion 13 â†’ 20 si nÃ©cessaire        â”‚
â”‚     - RÃ©cupÃ©ration code BCT de la structure â”‚
â”‚     - Ajout prÃ©fixe banque (03)             â”‚
â”‚     - Calcul clÃ© RIB (modulo 97)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. VÃ©rification intÃ©gritÃ© mathÃ©matique     â”‚
â”‚     - DÃ©composition : Banque|Agence|Cpte|ClÃ©â”‚
â”‚     - Appel VirementCmd.verifierRib()       â”‚
â”‚     - ContrÃ´le modulo 97                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. VÃ©rification compte BNA (03)            â”‚
â”‚     - Si banque != 03 : erreur              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. Recherche en base de donnÃ©es            â”‚
â”‚     - GetDetailContratCmd                   â”‚
â”‚     - VÃ©rification existence compte         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. ContrÃ´les mÃ©tier                        â”‚
â”‚     - Compte pas en devises                 â”‚
â”‚     - Compte pas en dinars convertibles     â”‚
â”‚     - Compte pas clÃ´turÃ© (Ã©tat != R)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7. RÃ©cupÃ©ration nom titulaire              â”‚
â”‚     - benificiaire = contrat.getNomInti()   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>
                </div>

                <h4>Calcul de la clÃ© RIB</h4>
                <pre><code>public String calculerRIB(String RIB) {
    if (RIB.length() == 18) {
        // RIB sans clÃ© (18 chiffres)
        BigInteger rr = new BigInteger(RIB + "00");
        int rest = rr.mod(new BigInteger("97")).intValue();
        int cle = 97 - rest;
        return String.format("%02d", cle);
    }
    return "";
}</code></pre>

                <h3>3.4 Consultation des ordres</h3>

                <h4>MÃ©thodes de recherche</h4>

                <table>
                    <tr>
                        <th>MÃ©thode</th>
                        <th>CritÃ¨re</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><code>rechercherGlobalVirementByRemise()</code></td>
                        <td>NumÃ©ro de remise</td>
                        <td>Recherche exacte par NÂ° remise</td>
                    </tr>
                    <tr>
                        <td><code>rechercherGlobalVirementByEtat()</code></td>
                        <td>Ã‰tat (A/E/R)</td>
                        <td>Filtrage par Ã©tat d'ordre</td>
                    </tr>
                    <tr>
                        <td><code>listeTousLesOrdresVirement()</code></td>
                        <td>Tous</td>
                        <td>Liste complÃ¨te des ordres</td>
                    </tr>
                    <tr>
                        <td><code>filtrerOrdres()</code></td>
                        <td>Montant min</td>
                        <td>Filtrage par montant minimal</td>
                    </tr>
                </table>

                <h4>Ã‰tats des ordres</h4>

                <table>
                    <tr>
                        <th>Code</th>
                        <th>LibellÃ©</th>
                        <th>Couleur UI</th>
                        <th>Actions possibles</th>
                    </tr>
                    <tr>
                        <td><span class="badge badge-warning">A</span></td>
                        <td>En Attente / AnnulÃ©</td>
                        <td style="color: #FFA500; font-weight: bold;">Orange</td>
                        <td>Modifier, ExÃ©cuter, Rejeter</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-danger">R</span></td>
                        <td>RejetÃ©</td>
                        <td style="color: #FF0000; font-weight: bold;">Rouge</td>
                        <td>Consulter uniquement</td>
                    </tr>
                    <tr>
                        <td><span class="badge badge-success">E</span></td>
                        <td>ExÃ©cutÃ©</td>
                        <td style="color: #008000; font-weight: bold;">Vert</td>
                        <td>Consulter uniquement</td>
                    </tr>
                </table>

                <h3>3.5 Modification d'ordres</h3>

                <h4>MÃ©thode : <code>modifierOrdreVirement()</code></h4>

                <p><strong>Modifications autorisÃ©es :</strong></p>
                <ul>
                    <li>âœ… Date d'exÃ©cution</li>
                    <li>âœ… Ajout de bÃ©nÃ©ficiaires (si &lt; 10)</li>
                    <li>âœ… Modification bÃ©nÃ©ficiaires existants</li>
                    <li>âœ… Suppression de bÃ©nÃ©ficiaires</li>
                </ul>

                <div class="warning-box">
                    <h4>âš ï¸ RÃ¨gles mÃ©tier</h4>
                    <ul>
                        <li>Seuls les ordres en Ã©tat "A" (En Attente) peuvent Ãªtre modifiÃ©s</li>
                        <li>Les ordres exÃ©cutÃ©s (E) ou rejetÃ©s (R) sont en lecture seule</li>
                        <li>Recalcul automatique des totaux aprÃ¨s modification</li>
                        <li>Les bÃ©nÃ©ficiaires supprimÃ©s sont conservÃ©s dans <code>listeBeneficiaireOrdreVirementSupprimes</code></li>
                    </ul>
                </div>

                <h4>Recalcul des totaux</h4>
                <pre><code>public void calculerTotauxGlobaux() {
    Long montantTotal = 0L;
    Long nombreTotal = 0L;

    for (BeneficiaireOrdreVirement benef : listeBeneficiaires) {
        if (benef.getMontOperBenf() != null) {
            montantTotal += benef.getMontOperBenf();
            nombreTotal++;
        }
    }

    selectedOrdreVirement.setMontGlobOvir(montantTotal);
    selectedOrdreVirement.setNbrVirOvir(nombreTotal);
}</code></pre>

                <h3>3.6 ExÃ©cution des virements</h3>

                <h4>MÃ©thode : <code>executerVirementDuJour()</code></h4>

                <p><strong>PrÃ©requis pour l'exÃ©cution :</strong></p>
                <ol>
                    <li>Ordre sÃ©lectionnÃ© non null</li>
                    <li>Ã‰tat = "A" (En Attente)</li>
                    <li>Au moins un bÃ©nÃ©ficiaire</li>
                </ol>

                <p><strong>Processus d'exÃ©cution :</strong></p>
                <pre><code>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Validation de l'ordre                  â”‚
â”‚     - Ã‰tat = "A" ?                         â”‚
â”‚     - BÃ©nÃ©ficiaires prÃ©sents ?             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Appel VirementCmd                      â”‚
â”‚     ExecutionOrdreVirementCentralDuJour()  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Traitement mÃ©tier                      â”‚
â”‚     - DÃ©blocage compte dÃ©biteur            â”‚
â”‚     - ExÃ©cution virements bÃ©nÃ©ficiaires    â”‚
â”‚     - Mise Ã  jour Ã©tats                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. Actualisation UI                       â”‚
â”‚     - Rechargement ordre depuis BDD        â”‚
â”‚     - RafraÃ®chissement liste bÃ©nÃ©ficiaires â”‚
â”‚     - Affichage messages erreur Ã©ventuels  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

                <h3>3.7 GÃ©nÃ©ration de rapports</h3>

                <h4>MÃ©thode : <code>imprimerVirementMandatBct()</code></h4>

                <p><strong>ParamÃ¨tres JasperReports :</strong></p>
                <table>
                    <tr>
                        <th>ParamÃ¨tre</th>
                        <th>Source</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><code>P_PATH</code></td>
                        <td>ServletContext</td>
                        <td>Chemin vers ressources Jasper</td>
                    </tr>
                    <tr>
                        <td><code>P_NUM_VIREMENT</code></td>
                        <td>NumOvirOvir</td>
                        <td>NumÃ©ro de remise</td>
                    </tr>
                    <tr>
                        <td><code>COMPTE_DEBIT_OVIR</code></td>
                        <td>CompteDebitOvir</td>
                        <td>Compte dÃ©biteur</td>
                    </tr>
                    <tr>
                        <td><code>COD_ETAT_OVIR</code></td>
                        <td>CodEtatOvir</td>
                        <td>Ã‰tat de l'ordre (converti)</td>
                    </tr>
                    <tr>
                        <td><code>COD_STRC_STRC</code></td>
                        <td>ParamAgence</td>
                        <td>Code structure</td>
                    </tr>
                    <tr>
                        <td><code>P_DATE_COMPTABLE</code></td>
                        <td>ParamAgence</td>
                        <td>Date comptable</td>
                    </tr>
                </table>

                <pre><code>public void imprimerVirementMandatBct() {
    try {
        // PrÃ©paration paramÃ¨tres
        parametersJasper.put("P_PATH", strPath);
        parametersJasper.put("P_NUM_VIREMENT", numeroRemise);
        parametersJasper.put("COD_ETAT_OVIR", convertirCodeEtat(etat));

        // Connexion base de donnÃ©es
        DataSource datasource = (DataSource) context.getBean("dataSource");
        Connection connection = datasource.getConnection();

        // GÃ©nÃ©ration PDF
        reportName = UtilCtr.printReport(
            "dechargeVirementCentrale",
            "Virement",
            parametersJasper,
            connection
        );

        // URL d'accÃ¨s au PDF
        setSrcRepport(contextPath + "/reporting/Virement/" + reportName);

    } catch (Exception e) {
        logger.error("Erreur gÃ©nÃ©ration PDF", e);
    }
}</code></pre>
            </div>

            <div id="section4" class="section">
                <h2>4. Structure du contrÃ´leur</h2>

                <h3>4.1 PropriÃ©tÃ©s principales</h3>

                <h4>DonnÃ©es de saisie</h4>
                <table>
                    <tr>
                        <th>PropriÃ©tÃ©</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><code>montantVirement</code></td>
                        <td>String</td>
                        <td>Montant du virement (formatÃ© avec espaces)</td>
                    </tr>
                    <tr>
                        <td><code>compteInterneMandat</code></td>
                        <td>String</td>
                        <td>Compte dÃ©biteur (compte interne mandat)</td>
                    </tr>
                    <tr>
                        <td><code>compteBenificiaire</code></td>
                        <td>String</td>
                        <td>RIB du bÃ©nÃ©ficiaire saisi</td>
                    </tr>
                    <tr>
                        <td><code>benificiaire</code></td>
                        <td>String</td>
                        <td>Nom du bÃ©nÃ©ficiaire (max 60 car.)</td>
                    </tr>
                    <tr>
                        <td><code>motif</code></td>
                        <td>String</td>
                        <td>Motif du virement (max 200 car.)</td>
                    </tr>
                    <tr>
                        <td><code>dateExecution</code></td>
                        <td>Date</td>
                        <td>Date d'exÃ©cution souhaitÃ©e</td>
                    </tr>
                </table>

                <h4>Collections</h4>
                <table>
                    <tr>
                        <th>PropriÃ©tÃ©</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><code>listeBeneficiaireOrdreVirement</code></td>
                        <td>List&lt;BeneficiaireOrdreVirement&gt;</td>
                        <td>Liste des bÃ©nÃ©ficiaires de l'ordre en cours</td>
                    </tr>
                    <tr>
                        <td><code>listeBeneficiaireOrdreVirementSupprimes</code></td>
                        <td>List&lt;BeneficiaireOrdreVirement&gt;</td>
                        <td>BÃ©nÃ©ficiaires supprimÃ©s (pour traÃ§abilitÃ©)</td>
                    </tr>
                    <tr>
                        <td><code>listeOrdresVirements</code></td>
                        <td>List&lt;OrdreVirement&gt;</td>
                        <td>Liste des ordres affichÃ©s (consultation)</td>
                    </tr>
                    <tr>
                        <td><code>listNumRemise</code></td>
                        <td>List&lt;String&gt;</td>
                        <td>Liste des numÃ©ros de remise existants</td>
                    </tr>
                    <tr>
                        <td><code>listNumCompteInterne</code></td>
                        <td>List&lt;String&gt;</td>
                        <td>Comptes internes disponibles</td>
                    </tr>
                </table>

                <h4>Ã‰tat et contrÃ´le</h4>
                <table>
                    <tr>
                        <th>PropriÃ©tÃ©</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><code>etatCmdValiderVirement</code></td>
                        <td>boolean</td>
                        <td>Activation/dÃ©sactivation bouton validation</td>
                    </tr>
                    <tr>
                        <td><code>etatSaveBenefVir</code></td>
                        <td>boolean</td>
                        <td>Statut enregistrement bÃ©nÃ©ficiaire</td>
                    </tr>
                    <tr>
                        <td><code>etatRIBCorrecte</code></td>
                        <td>boolean</td>
                        <td>Indicateur validitÃ© RIB</td>
                    </tr>
                    <tr>
                        <td><code>modeModification</code></td>
                        <td>boolean</td>
                        <td>Mode modification bÃ©nÃ©ficiaire actif</td>
                    </tr>
                    <tr>
                        <td><code>strEtatValidationTrt</code></td>
                        <td>String</td>
                        <td>Ã‰tat validation : "0"=init, "1"=succÃ¨s, "2"=Ã©chec</td>
                    </tr>
                </table>

                <h4>Messages</h4>
                <table>
                    <tr>
                        <th>PropriÃ©tÃ©</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><code>messageMontant</code></td>
                        <td>Message validation montant</td>
                    </tr>
                    <tr>
                        <td><code>msgValidatorCompte</code></td>
                        <td>Message validation RIB</td>
                    </tr>
                    <tr>
                        <td><code>messageValidationVirementBct</code></td>
                        <td>Message validation ordre complet</td>
                    </tr>
                    <tr>
                        <td><code>messageEnregistBenefVirement</code></td>
                        <td>Message ajout bÃ©nÃ©ficiaire</td>
                    </tr>
                    <tr>
                        <td><code>messageInformation</code></td>
                        <td>Message informationnel gÃ©nÃ©ral</td>
                    </tr>
                    <tr>
                        <td><code>messageErreur</code></td>
                        <td>Message d'erreur</td>
                    </tr>
                </table>

                <h3>4.2 Constantes</h3>

                <pre><code>public class PecVirementCentralCtr implements Serializable {

    // Limite mÃ©tier
    private static final int LIMITE_MAX_BENEFICIAIRES = 10;

    // Codes produits
    public static Long codPrdVirementPonctuel = 1063L;
    public static Long etatVirementPonctuelEncour = 0L;

    // Logger
    Logger logger = Logger.getLogger(PecVirementCentralCtr.class);
}</code></pre>

                <h3>4.3 Organisation des mÃ©thodes (par catÃ©gorie)</h3>

                <h4>ğŸ“ Initialisation et cycle de vie</h4>
                <ul>
                    <li><code>@PostConstruct init()</code> - Initialisation du bean</li>
                </ul>

                <h4>âœ… Validation</h4>
                <ul>
                    <li><code>validateMontant()</code> - Validation format montant</li>
                    <li><code>validaterFormatCompte()</code> - Validation format RIB</li>
                    <li><code>validateDateFormat()</code> - Validation format date</li>
                    <li><code>verifierCompte()</code> - VÃ©rification complÃ¨te compte bÃ©nÃ©ficiaire</li>
                    <li><code>verifierRib()</code> - VÃ©rification RIB (version simplifiÃ©e)</li>
                </ul>

                <h4>â• Gestion bÃ©nÃ©ficiaires</h4>
                <ul>
                    <li><code>creerNouveauBenefVirement()</code> - RÃ©initialisation formulaire</li>
                    <li><code>ajouterBeneficiaireVirement()</code> - Ajout nouveau bÃ©nÃ©ficiaire</li>
                    <li><code>editerBeneficiaireVirement()</code> - Charger bÃ©nÃ©ficiaire pour Ã©dition</li>
                    <li><code>modifierBeneficiaire()</code> - Sauvegarder modifications</li>
                    <li><code>supprimerBeneficiaireVirement()</code> - Supprimer bÃ©nÃ©ficiaire</li>
                    <li><code>calculerTotauxGlobaux()</code> - Recalcul montant total et nombre</li>
                </ul>

                <h4>ğŸ’¾ CRUD Ordres de virement</h4>
                <ul>
                    <li><code>validerVirementMandatBct()</code> - CrÃ©er et valider ordre</li>
                    <li><code>rechercherGlobalVirementByRemise()</code> - Recherche par NÂ° remise</li>
                    <li><code>rechercherGlobalVirementByEtat()</code> - Recherche par Ã©tat</li>
                    <li><code>listeTousLesOrdresVirement()</code> - Lister tous les ordres</li>
                    <li><code>modifierOrdreVirement()</code> - Modifier ordre existant</li>
                    <li><code>rejeterOrdreVirement()</code> - Rejeter un ordre</li>
                </ul>

                <h4>â–¶ï¸ ExÃ©cution</h4>
                <ul>
                    <li><code>executerVirementDuJour()</code> - ExÃ©cuter ordre sÃ©lectionnÃ©</li>
                    <li><code>executerOrdreSelectionne()</code> - Wrapper avec validations</li>
                    <li><code>isPeutExecuterOrdre()</code> - VÃ©rifier possibilitÃ© exÃ©cution</li>
                </ul>

                <h4>ğŸ“„ Rapports</h4>
                <ul>
                    <li><code>imprimerVirementMandatBct()</code> - GÃ©nÃ©rer PDF dÃ©charge</li>
                </ul>

                <h4>ğŸ”§ Utilitaires</h4>
                <ul>
                    <li><code>calculerRIB()</code> - Calcul clÃ© RIB (modulo 97)</li>
                    <li><code>convertirCodeEtat()</code> - Conversion code â†’ libellÃ©</li>
                    <li><code>getCouleurEtatOrdre()</code> - Style CSS selon Ã©tat</li>
                    <li><code>getSeqAgence()</code> - RÃ©cupÃ©ration sÃ©quence</li>
                    <li><code>formatMontant()</code> - Formatage montants</li>
                </ul>

                <h4>ğŸ”„ Navigation et rÃ©initialisation</h4>
                <ul>
                    <li><code>quitterVirementMandatBct()</code> - Retour menu</li>
                    <li><code>annulerBoutton()</code> - Annulation saisie</li>
                    <li><code>reinitialiserTout()</code> - Reset complet</li>
                    <li><code>viderFormulaire()</code> - Vider champs saisie</li>
                </ul>

                <h3>4.4 MÃ©triques du code</h3>

                <table>
                    <tr>
                        <th>MÃ©trique</th>
                        <th>Valeur</th>
                        <th>Observation</th>
                    </tr>
                    <tr>
                        <td>Nombre de lignes</td>
                        <td>3261</td>
                        <td><span class="badge badge-warning">TrÃ¨s Ã©levÃ©</span></td>
                    </tr>
                    <tr>
                        <td>Nombre de mÃ©thodes</td>
                        <td>~70</td>
                        <td><span class="badge badge-warning">Ã‰levÃ©</span></td>
                    </tr>
                    <tr>
                        <td>Nombre de propriÃ©tÃ©s</td>
                        <td>~80</td>
                        <td><span class="badge badge-warning">TrÃ¨s Ã©levÃ©</span></td>
                    </tr>
                    <tr>
                        <td>ComplexitÃ© cyclomatique</td>
                        <td>Ã‰levÃ©e</td>
                        <td><span class="badge badge-danger">Refactoring recommandÃ©</span></td>
                    </tr>
                    <tr>
                        <td>Gestion erreurs</td>
                        <td>Try-catch gÃ©nÃ©riques</td>
                        <td><span class="badge badge-warning">Ã€ amÃ©liorer</span></td>
                    </tr>
                </table>
            </div>

        </div>

        <div class="footer">
            <p>ğŸ“„ Rapport gÃ©nÃ©rÃ© automatiquement pour le module PecVirementCentralCtr</p>
            <p>SystÃ¨me SMILE - Banque Nationale Agricole Â© 2025</p>
        </div>
    </div>

    <script>
        // Smooth scroll pour les liens de la table des matiÃ¨res
        document.querySelectorAll('.toc a').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                target.scrollIntoView({ behavior: 'smooth', block: 'start' });
            });
        });
    </script>
</body>
</html>
