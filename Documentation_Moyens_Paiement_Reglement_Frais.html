<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentation Fonctionnelle - Moyens de Paiement pour R√®glement Frais Agence</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        header {
            background: linear-gradient(135deg, #1e5d8c 0%, #2a7ab8 100%);
            color: white;
            padding: 40px;
            text-align: center;
            border-radius: 10px 10px 0 0;
            margin: -20px -20px 30px -20px;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .toc {
            background-color: #f8f9fa;
            border-left: 4px solid #2a7ab8;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 5px;
        }

        .toc h2 {
            color: #1e5d8c;
            margin-bottom: 15px;
        }

        .toc ul {
            list-style: none;
        }

        .toc ul li {
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .toc ul li:last-child {
            border-bottom: none;
        }

        .toc a {
            color: #2a7ab8;
            text-decoration: none;
            transition: all 0.3s;
        }

        .toc a:hover {
            color: #1e5d8c;
            padding-left: 10px;
        }

        section {
            margin-bottom: 50px;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        h2 {
            color: #1e5d8c;
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #2a7ab8;
        }

        h3 {
            color: #2a7ab8;
            font-size: 1.5em;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        h4 {
            color: #4a6fa5;
            font-size: 1.2em;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        h5 {
            color: #5a7fa5;
            font-size: 1.1em;
            margin-top: 15px;
            margin-bottom: 10px;
        }

        .operation-box {
            background: linear-gradient(to right, #e6f2ff, white);
            border-left: 5px solid #2a7ab8;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .operation-box h3 {
            color: #1e5d8c;
            margin-top: 0;
        }

        .payment-method {
            background-color: #fff8e6;
            border-left: 4px solid #f39c12;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .payment-method h4 {
            color: #d68910;
            margin-top: 0;
        }

        .flow-diagram {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
            border: 2px solid #e0e0e0;
        }

        .flow-step {
            background-color: white;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #2a7ab8;
            border-radius: 3px;
            position: relative;
        }

        .flow-step::after {
            content: '‚Üì';
            display: block;
            text-align: center;
            font-size: 1.5em;
            color: #2a7ab8;
            margin-top: 10px;
        }

        .flow-step:last-child::after {
            content: '';
        }

        .flow-step h5 {
            color: #1e5d8c;
            margin-bottom: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        thead {
            background: linear-gradient(135deg, #2a7ab8 0%, #1e5d8c 100%);
            color: white;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.9em;
            letter-spacing: 0.5px;
        }

        tbody tr:hover {
            background-color: #f8f9fa;
            transition: background-color 0.3s;
        }

        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 0.85em;
            font-weight: 600;
            margin-right: 5px;
        }

        .badge-virement {
            background-color: #3498db;
            color: white;
        }

        .badge-cheque {
            background-color: #2ecc71;
            color: white;
        }

        .badge-compte {
            background-color: #9b59b6;
            color: white;
        }

        .badge-warning {
            background-color: #f39c12;
            color: white;
        }

        .badge-danger {
            background-color: #e74c3c;
            color: white;
        }

        .alert {
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            border-left: 4px solid;
        }

        .alert-info {
            background-color: #d1ecf1;
            border-color: #0c5460;
            color: #0c5460;
        }

        .alert-warning {
            background-color: #fff3cd;
            border-color: #856404;
            color: #856404;
        }

        .alert-success {
            background-color: #d4edda;
            border-color: #155724;
            color: #155724;
        }

        .code-ref {
            background-color: #f8f9fa;
            padding: 10px 15px;
            border-left: 3px solid #28a745;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            border-radius: 3px;
        }

        .code-ref::before {
            content: 'üìÇ ';
            margin-right: 5px;
        }

        .formula {
            background-color: #f0f7ff;
            padding: 15px;
            border: 1px dashed #2a7ab8;
            border-radius: 5px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
        }

        .grid-2col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .card {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
        }

        .card h4 {
            color: #1e5d8c;
            margin-top: 0;
        }

        ul, ol {
            margin-left: 30px;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        li {
            margin: 8px 0;
        }

        footer {
            background-color: #1e5d8c;
            color: white;
            text-align: center;
            padding: 20px;
            margin: 50px -20px -20px -20px;
            border-radius: 0 0 10px 10px;
        }

        @media print {
            body {
                background-color: white;
            }
            .container {
                box-shadow: none;
            }
            section {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìã Documentation Fonctionnelle</h1>
            <p>Moyens de Paiement pour R√®glement Frais au Niveau de l'Agence</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Syst√®me SMILE BNA - Projet R√®glement Frais Auxiliaires, D√©penses Agence & Loyer</p>
        </header>

        <div class="toc">
            <h2>üìë Table des Mati√®res</h2>
            <ul>
                <li><a href="#section1">1. Vue d'Ensemble et Contexte</a></li>
                <li><a href="#section2">2. Moyens de Paiement Disponibles dans SMILE</a></li>
                <li><a href="#section3">3. Op√©ration 1 : R√®glement Frais Auxiliaires</a></li>
                <li><a href="#section4">4. Op√©ration 2 : R√®glement D√©penses Agence</a></li>
                <li><a href="#section5">5. Op√©ration 3 : R√®glement Loyer</a></li>
                <li><a href="#section6">6. Flux de Paiement par Moyen</a></li>
                <li><a href="#section7">7. Int√©gration avec l'Existant SMILE</a></li>
                <li><a href="#section8">8. Sch√©mas Comptables et CRO</a></li>
            </ul>
        </div>

        <section id="section1">
            <h2>1. Vue d'Ensemble et Contexte</h2>

            <div class="alert alert-info">
                <strong>üìå Objectif du Projet:</strong> Mettre en place une solution permettant la gestion automatis√©e des frais li√©s aux prestations fournies par les auxiliaires (avocats, huissiers, experts), des d√©penses d'agence, et des r√®glements de loyer, via le d√©bit direct du compte bancaire du client ou de l'agence.
            </div>

            <h3>1.1 Port√©e Fonctionnelle</h3>
            <p>Le syst√®me doit g√©rer trois types d'op√©rations de r√®glement:</p>

            <div class="grid-2col">
                <div class="card">
                    <h4>üèõÔ∏è Frais Auxiliaires</h4>
                    <ul>
                        <li>Avocats (conventionn√©s/non conventionn√©s)</li>
                        <li>Huissiers</li>
                        <li>Experts</li>
                    </ul>
                    <p><strong>Particularit√©:</strong> Calculs complexes TVA, retenues √† la source</p>
                </div>

                <div class="card">
                    <h4>üè¢ D√©penses Agence</h4>
                    <ul>
                        <li>Factures T√©l√©com, STEG, SONEDE</li>
                        <li>Entretiens et r√©parations</li>
                        <li>Timbrage, enregistrement</li>
                        <li>Autres d√©penses</li>
                    </ul>
                </div>
            </div>

            <div class="card" style="margin-top: 20px;">
                <h4>üè† R√®glement Loyer</h4>
                <ul>
                    <li>Loyer agence / direction r√©gionale</li>
                    <li>Logement de fonction (Chef d'agence / DR)</li>
                    <li>P√©riodicit√©: Mensuel, Trimestriel, Semestriel, Annuel</li>
                    <li>Gestion des majorations p√©riodiques</li>
                </ul>
            </div>

            <h3>1.2 Principes de Fonctionnement</h3>
            <p>Chaque op√©ration suit un workflow en 3 phases:</p>

            <div class="flow-diagram">
                <div class="flow-step">
                    <h5>Phase 1: Prise en Charge (PEC)</h5>
                    <p>Saisie des informations du b√©n√©ficiaire, nature de la d√©pense, montants, et calculs automatiques (TVA, retenues)</p>
                </div>

                <div class="flow-step">
                    <h5>Phase 2: Validation</h5>
                    <p>V√©rification et approbation des donn√©es. Possibilit√© de modification ou annulation avant validation</p>
                </div>

                <div class="flow-step">
                    <h5>Phase 3: R√®glement</h5>
                    <p>Ex√©cution du paiement selon le moyen choisi (virement, ch√®que BCT)</p>
                </div>
            </div>
        </section>

        <section id="section2">
            <h2>2. Moyens de Paiement Disponibles dans SMILE</h2>

            <div class="alert alert-success">
                <strong>‚úì Conformit√© CDC:</strong> Selon le cahier de charges, les moyens de paiement utilis√©s sont le <strong>virement</strong> et le <strong>ch√®que BCT</strong>. Le syst√®me SMILE dispose de modules complets pour ces deux moyens.
            </div>

            <h3>2.1 Virement Bancaire</h3>

            <div class="payment-method">
                <h4><span class="badge badge-virement">VIREMENT</span> Module Virement SMILE</h4>

                <div class="code-ref">smile/src/main/java/com/bna/smile/web/virement/</div>

                <p><strong>Types de virements disponibles dans SMILE:</strong></p>

                <table>
                    <thead>
                        <tr>
                            <th>Type Virement</th>
                            <th>Code Produit</th>
                            <th>Contr√¥leur Principal</th>
                            <th>Applicable au CDC</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Virement Ponctuel</strong></td>
                            <td>1063</td>
                            <td>PecVirementPonctuelCtr.java</td>
                            <td><span class="badge badge-warning">‚úì OUI</span></td>
                        </tr>
                        <tr>
                            <td><strong>Virement Permanent</strong></td>
                            <td>1064</td>
                            <td>PecVirementPermanentCtr.java</td>
                            <td><span class="badge badge-warning">‚úì OUI (Loyer p√©riodique)</span></td>
                        </tr>
                        <tr>
                            <td><strong>Virement Compte √† Compte</strong></td>
                            <td>-</td>
                            <td>PecVirementCompteACompteCtr.java</td>
                            <td><span class="badge badge-warning">‚úì OUI (BNA‚ÜíBNA)</span></td>
                        </tr>
                        <tr>
                            <td><strong>Virement Masse</strong></td>
                            <td>1065</td>
                            <td>PecVirementMasseCtr.java</td>
                            <td><span class="badge badge-danger">‚úó Non applicable</span></td>
                        </tr>
                        <tr>
                            <td><strong>Virement Devise</strong></td>
                            <td>-</td>
                            <td>PecVirementDeviseCtr.java</td>
                            <td><span class="badge badge-danger">‚úó Non applicable</span></td>
                        </tr>
                        <tr>
                            <td><strong>Virement Central (CAPI)</strong></td>
                            <td>-</td>
                            <td>PecVirementCentralCtr.java</td>
                            <td><span class="badge badge-danger">‚úó Non applicable</span></td>
                        </tr>
                    </tbody>
                </table>

                <h5>Virements Applicables pour le CDC:</h5>

                <div class="card" style="margin-top: 15px;">
                    <h4>1. Virement Compte √† Compte (BNA ‚Üí BNA)</h4>
                    <p><strong>Usage:</strong> Pour les auxiliaires ayant un compte BNA</p>
                    <p><strong>Avantages:</strong></p>
                    <ul>
                        <li>Ex√©cution imm√©diate</li>
                        <li>Pas de frais de compensation</li>
                        <li>Tra√ßabilit√© compl√®te</li>
                        <li>Cr√©dit instantan√© du b√©n√©ficiaire</li>
                    </ul>
                    <div class="code-ref">smile/model/virement/traitement/ValiderVirementCompteACompteTrt.java</div>
                    <p><strong>Flux:</strong> PEC ‚Üí Validation ‚Üí D√©bit compte client ‚Üí Cr√©dit compte b√©n√©ficiaire (m√™me op√©ration)</p>
                </div>

                <div class="card" style="margin-top: 15px;">
                    <h4>2. Virement Ponctuel Inter-Banques</h4>
                    <p><strong>Usage:</strong> Pour les b√©n√©ficiaires avec compte dans une autre banque</p>
                    <p><strong>Processus:</strong></p>
                    <ul>
                        <li>D√©bit compte client (agence √©mettrice)</li>
                        <li>G√©n√©ration fichier t√©l√©-compensable SIBTEL</li>
                        <li>Envoi √† la tr√©sorerie</li>
                        <li>Compensation via syst√®me BCT</li>
                    </ul>
                    <div class="code-ref">smile/model/virement/traitement/ExecutionDoVirPonctuelTrt.java</div>
                    <div class="code-ref">smile/model/virement/traitement/CreationFichierVirementTrt.java</div>
                </div>

                <div class="card" style="margin-top: 15px;">
                    <h4>3. Virement Permanent (Pour Loyer)</h4>
                    <p><strong>Usage:</strong> R√®glement loyer p√©riodique</p>
                    <p><strong>P√©riodicit√©s support√©es:</strong></p>
                    <ul>
                        <li>Mensuelle (M)</li>
                        <li>Trimestrielle (T)</li>
                        <li>Semestrielle (S)</li>
                        <li>Annuelle (A)</li>
                    </ul>
                    <div class="code-ref">smile/model/virement/traitement/TraiterExecutionVirPermanentTrt.java</div>
                    <p><strong>Fonctionnalit√©s:</strong></p>
                    <ul>
                        <li>Ex√©cution automatique selon √©ch√©ancier</li>
                        <li>Gestion des √©ch√©ances</li>
                        <li>Modification/r√©siliation possible</li>
                        <li>D√©calage automatique si provision insuffisante</li>
                    </ul>
                </div>
            </div>

            <h3>2.2 Ch√®que BCT</h3>

            <div class="payment-method">
                <h4><span class="badge badge-cheque">CH√àQUE BCT</span> Syst√®me IBS (International Banking System)</h4>

                <div class="code-ref">smile/src/main/java/com/bna/smile/web/IBS/</div>
                <div class="code-ref">smile/src/main/java/com/bna/smile/model/IBS/</div>

                <p><strong>Description:</strong> Le ch√®que BCT est √©mis via le syst√®me IBS pour les r√®glements importants n√©cessitant une garantie bancaire maximale.</p>

                <h5>Fonctionnalit√©s IBS pour Ch√®que BCT:</h5>

                <table>
                    <thead>
                        <tr>
                            <th>Op√©ration</th>
                            <th>CRO</th>
                            <th>Fichier Traitement</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>√âmission Ch√®que BCT</td>
                            <td>2230</td>
                            <td>Cro2230EmissionChequeBCTAchatBBEEmisTrt.java</td>
                            <td>Cr√©ation et √©mission du ch√®que BCT</td>
                        </tr>
                        <tr>
                            <td>Retrait Ch√®que IBS</td>
                            <td>2212</td>
                            <td>Cro2212RetraitChequeIBSEmisTrt.java</td>
                            <td>Remise du ch√®que au b√©n√©ficiaire</td>
                        </tr>
                        <tr>
                            <td>R√®glement Facture IBS</td>
                            <td>-</td>
                            <td>GestionFondsDinarIBSCtr.java</td>
                            <td>Gestion des fonds pour √©mission</td>
                        </tr>
                    </tbody>
                </table>

                <div class="alert alert-warning">
                    <strong>‚ö†Ô∏è Important:</strong> Selon le CDC (RG 3 - Op√©ration 1), le ch√®que BCT est √©tabli √† travers la fonctionnalit√© existante "√âtablissement ch√®que BCT" du module IBS.
                </div>

                <h5>Processus d'√âmission Ch√®que BCT:</h5>

                <div class="flow-diagram">
                    <div class="flow-step">
                        <h5>√âtape 1: Demande d'√âmission</h5>
                        <p>L'agence demande l'√©tablissement d'un ch√®que BCT via le module IBS</p>
                        <p><strong>Donn√©es requises:</strong> B√©n√©ficiaire, montant, motif</p>
                    </div>

                    <div class="flow-step">
                        <h5>√âtape 2: Validation Tr√©sorerie</h5>
                        <p>La tr√©sorerie valide la demande et g√©n√®re le ch√®que</p>
                        <p><strong>V√©rifications:</strong> Fonds disponibles, identit√© b√©n√©ficiaire</p>
                    </div>

                    <div class="flow-step">
                        <h5>√âtape 3: √âmission et Comptabilisation</h5>
                        <p>G√©n√©ration CRO 2230 - D√©bit compte √©metteur</p>
                        <p><strong>Sch√©ma comptable:</strong> D√©bit 410/Cr√©dit compte agence</p>
                    </div>

                    <div class="flow-step">
                        <h5>√âtape 4: Remise au B√©n√©ficiaire</h5>
                        <p>Le ch√®que BCT est remis au b√©n√©ficiaire</p>
                        <p><strong>Tra√ßabilit√©:</strong> Enregistrement de la remise, signature</p>
                    </div>
                </div>
            </div>

            <h3>2.3 Tableau Comparatif des Moyens de Paiement</h3>

            <table>
                <thead>
                    <tr>
                        <th>Crit√®re</th>
                        <th>Virement Compte √† Compte</th>
                        <th>Virement Inter-Banques</th>
                        <th>Ch√®que BCT</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Rapidit√©</strong></td>
                        <td>‚úì‚úì‚úì Imm√©diat</td>
                        <td>‚úì‚úì 1-2 jours (compensation)</td>
                        <td>‚úì Manuel</td>
                    </tr>
                    <tr>
                        <td><strong>Co√ªt</strong></td>
                        <td>‚úì‚úì‚úì Minimal</td>
                        <td>‚úì‚úì Frais compensation</td>
                        <td>‚úì Frais √©mission ch√®que</td>
                    </tr>
                    <tr>
                        <td><strong>S√©curit√©</strong></td>
                        <td>‚úì‚úì‚úì Tr√®s √©lev√©e</td>
                        <td>‚úì‚úì‚úì Tr√®s √©lev√©e</td>
                        <td>‚úì‚úì‚úì‚úì Garantie BCT</td>
                    </tr>
                    <tr>
                        <td><strong>Tra√ßabilit√©</strong></td>
                        <td>‚úì‚úì‚úì Compl√®te</td>
                        <td>‚úì‚úì‚úì Compl√®te</td>
                        <td>‚úì‚úì Physique + num√©rique</td>
                    </tr>
                    <tr>
                        <td><strong>Automatisation</strong></td>
                        <td>‚úì‚úì‚úì Totale</td>
                        <td>‚úì‚úì‚úì Totale (fichier SIBTEL)</td>
                        <td>‚úì Partielle</td>
                    </tr>
                    <tr>
                        <td><strong>Cas d'usage CDC</strong></td>
                        <td>Auxiliaires compte BNA</td>
                        <td>Auxiliaires autre banque</td>
                        <td>Montants importants</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="section3">
            <h2>3. Op√©ration 1 : R√®glement Frais Auxiliaires</h2>

            <div class="operation-box">
                <h3>üìã Vue d'Ensemble</h3>
                <p><strong>Objectif:</strong> Permettre le r√®glement des frais d'avocats, huissiers et experts √† la charge du client</p>
                <p><strong>Moyens de paiement utilis√©s:</strong></p>
                <ul>
                    <li><span class="badge badge-virement">Virement</span> - Si auxiliaire dispose d'un compte BNA ou autre banque</li>
                    <li><span class="badge badge-cheque">Ch√®que BCT</span> - Pour r√®glement via tr√©sorerie</li>
                </ul>
            </div>

            <h3>3.1 Flux de Paiement par Virement (Compte BNA)</h3>

            <div class="flow-diagram">
                <div class="flow-step">
                    <h5>1. PEC Frais Auxiliaires</h5>
                    <p><strong>Contr√¥leur nouveau:</strong> ReglementFraisAuxiliairesCtr.java</p>
                    <p><strong>Action:</strong></p>
                    <ul>
                        <li>Identification client (NP, N¬∞ pi√®ce, N15 compte)</li>
                        <li>Choix type auxiliaire: Avocat/Huissier/Expert</li>
                        <li>Choix nature: Conventionn√©/Non conventionn√©</li>
                        <li>Saisie montants: Honoraires HT + Frais remboursables</li>
                        <li>Calculs automatiques: TVA, retenues, montant net</li>
                        <li>Choix moyen paiement: <strong>Virement</strong></li>
                        <li>Saisie RIB b√©n√©ficiaire (auxiliaire)</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>2. Validation Frais Auxiliaires</h5>
                    <p><strong>Action:</strong> Validation des donn√©es saisies</p>
                    <p><strong>Si moyen = Virement et RIB BNA:</strong></p>
                    <ul>
                        <li>Appel module virement existant</li>
                        <li>Utilisation: <strong>PecVirementCompteACompteCtr.java</strong></li>
                        <li>Passage param√®tres:
                            <div class="formula">
                            - compteDebiteur = compte client<br>
                            - compteCrediteur = RIB auxiliaire<br>
                            - montantVirement = montant √† servir<br>
                            - motif = "R√®glement frais [Type] - Affaire [NumAffaire]"
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>3. Ex√©cution Virement</h5>
                    <p><strong>Traitement:</strong> ValiderVirementCompteACompteTrt.java</p>
                    <p><strong>Actions:</strong></p>
                    <ul>
                        <li>V√©rification provision compte client</li>
                        <li>D√©bit compte client du montant √† servir</li>
                        <li>Cr√©dit compte auxiliaire (BNA)</li>
                        <li>G√©n√©ration CRO virement compte √† compte</li>
                        <li>Mise √† jour √©tat frais = REGLE</li>
                    </ul>
                </div>
            </div>

            <h3>3.2 Flux de Paiement par Virement (Autre Banque)</h3>

            <div class="flow-diagram">
                <div class="flow-step">
                    <h5>1. PEC et Validation (identique)</h5>
                    <p>M√™me processus que virement BNA jusqu'√† la validation</p>
                    <p><strong>D√©tection:</strong> RIB ne commence pas par "03" (code banque BNA)</p>
                </div>

                <div class="flow-step">
                    <h5>2. Cr√©ation Ordre de Virement</h5>
                    <p><strong>Traitement:</strong> SaveGlobalVirementTrt.java</p>
                    <p><strong>Action:</strong></p>
                    <ul>
                        <li>Cr√©ation GlobalVirement</li>
                        <li>Cr√©ation DetailVirement pour l'auxiliaire</li>
                        <li>Type produit = Virement Ponctuel (1063)</li>
                        <li>G√©n√©ration num√©ro de remise</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>3. Ex√©cution et G√©n√©ration Fichier</h5>
                    <p><strong>Traitement:</strong> ExecutionDoVirPonctuelTrt.java</p>
                    <p><strong>Actions:</strong></p>
                    <ul>
                        <li>D√©bit compte client</li>
                        <li>G√©n√©ration CRO 715 (Ex√©cution DO)</li>
                        <li>G√©n√©ration CRO 721 (Envoi virement)</li>
                        <li>Ajout au fichier t√©l√©-compensable</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>4. Envoi Tr√©sorerie</h5>
                    <p><strong>Traitement:</strong> CreationFichierVirementTrt.java</p>
                    <p><strong>Action:</strong></p>
                    <ul>
                        <li>G√©n√©ration fichier SIBTEL format√©</li>
                        <li>Envoi FTP vers tr√©sorerie</li>
                        <li>Compensation via syst√®me BCT</li>
                        <li>Cr√©dit compte b√©n√©ficiaire par sa banque (J+1/J+2)</li>
                    </ul>
                </div>
            </div>

            <h3>3.3 Flux de Paiement par Ch√®que BCT</h3>

            <div class="flow-diagram">
                <div class="flow-step">
                    <h5>1. PEC Frais Auxiliaires</h5>
                    <p>M√™me processus de saisie</p>
                    <p><strong>Choix moyen paiement:</strong> <span class="badge badge-cheque">Ch√®que BCT</span></p>
                </div>

                <div class="flow-step">
                    <h5>2. Validation et Envoi Tr√©sorerie</h5>
                    <p><strong>Action:</strong></p>
                    <ul>
                        <li>D√©bit compte client du montant √† servir</li>
                        <li>Cr√©ation demande ch√®que BCT</li>
                        <li>Envoi donn√©es √† tr√©sorerie:
                            <div class="formula">
                            - B√©n√©ficiaire: [Nom Auxiliaire]<br>
                            - Montant: [Montant √† servir]<br>
                            - Motif: "Honoraires [Type] - Affaire [NumAffaire]"<br>
                            - RIB b√©n√©ficiaire (si disponible)
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>3. √âtablissement Ch√®que BCT (Tr√©sorerie)</h5>
                    <p><strong>Module:</strong> IBS - √âtablissement Ch√®que BCT</p>
                    <p><strong>Traitement:</strong></p>
                    <ul>
                        <li>R√©ception demande agence</li>
                        <li>Validation et √©mission ch√®que BCT</li>
                        <li>G√©n√©ration CRO 2230 (√âmission ch√®que BCT)</li>
                        <li>Impression ch√®que physique</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>4. Remise au B√©n√©ficiaire</h5>
                    <p><strong>Action:</strong></p>
                    <ul>
                        <li>Notification agence que ch√®que est pr√™t</li>
                        <li>Remise ch√®que √† l'auxiliaire</li>
                        <li>Signature d√©charge</li>
                        <li>Mise √† jour √©tat frais = REGLE</li>
                    </ul>
                </div>
            </div>

            <h3>3.4 Calculs Financiers (Commun √† tous les moyens)</h3>

            <div class="card">
                <h4>Formules de Calcul</h4>

                <p><strong>Pour Auxiliaire Conventionn√©:</strong></p>
                <div class="formula">
Montant TTC = Honoraires HT + (Honoraires HT √ó Taux TVA)<br>
Retenue √† la source = Montant TTC √ó Taux R/S<br>
TVA d√©ductible = (Honoraires HT √ó Taux TVA) √ó Taux TVA d√©ductible<br>
Retenue sur TVA = (Honoraires HT √ó Taux TVA) √ó Taux R/S TVA (si TTC > 1000 DT)<br>
<br>
<strong>Montant Honoraires = Montant TTC - TVA d√©ductible</strong><br>
<strong>Montant √† servir = Montant TTC - Retenue √† la source - Retenue sur TVA + Frais remboursables</strong>
                </div>

                <p style="margin-top: 20px;"><strong>Exemple (page 5 du CDC):</strong></p>
                <div class="formula">
Honoraires HT = 78 000 DT<br>
Frais remboursables = 36 000 DT<br>
TVA = 19%, R/S = 3%, TVA d√©ductible = 25%<br>
<br>
Montant TTC = 78000 + (78000 √ó 19%) = 92 820 DT<br>
Retenue √† la source = 92820 √ó 3% = 2 784.60 DT<br>
TVA d√©ductible = (78000 √ó 19%) √ó 25% = 3 705 DT<br>
Retenue sur TVA = 0 DT (TTC < 1000 non applicable dans cet exemple)<br>
<br>
Montant Honoraires = 92820 - 3705 = 89 115 DT<br>
<strong>Montant √† servir = 92820 - 2784.60 + 36000 = 126 035.40 DT</strong>
                </div>
            </div>

            <h3>3.5 Mapping avec l'Existant SMILE</h3>

            <table>
                <thead>
                    <tr>
                        <th>Fonctionnalit√© CDC</th>
                        <th>Module SMILE Existant</th>
                        <th>Int√©gration</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Choix moyen paiement</td>
                        <td>-</td>
                        <td><strong>Nouveau:</strong> Interface s√©lection virement/ch√®que BCT</td>
                    </tr>
                    <tr>
                        <td>Virement BNA ‚Üí BNA</td>
                        <td>PecVirementCompteACompteCtr.java</td>
                        <td><strong>R√©utilisation:</strong> Appel direct avec param√®tres</td>
                    </tr>
                    <tr>
                        <td>Virement autre banque</td>
                        <td>PecVirementPonctuelCtr.java<br>ExecutionDoVirPonctuelTrt.java</td>
                        <td><strong>R√©utilisation:</strong> Cr√©ation GlobalVirement + Ex√©cution</td>
                    </tr>
                    <tr>
                        <td>Fichier t√©l√©-compensable</td>
                        <td>CreationFichierVirementTrt.java</td>
                        <td><strong>R√©utilisation:</strong> G√©n√©ration SIBTEL</td>
                    </tr>
                    <tr>
                        <td>Ch√®que BCT</td>
                        <td>Module IBS - GestionFondsDinarIBSCtr.java</td>
                        <td><strong>R√©utilisation:</strong> Fonctionnalit√© √©tablissement ch√®que BCT</td>
                    </tr>
                    <tr>
                        <td>D√©bit compte client</td>
                        <td>InsertionOperationMoyPaySansCROTrt.java</td>
                        <td><strong>R√©utilisation:</strong> Op√©ration comptable d√©bit</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="section4">
            <h2>4. Op√©ration 2 : R√®glement D√©penses Agence</h2>

            <div class="operation-box">
                <h3>üè¢ Vue d'Ensemble</h3>
                <p><strong>Objectif:</strong> G√©rer le r√®glement des factures et d√©penses courantes de l'agence</p>
                <p><strong>Types de d√©penses:</strong></p>
                <ul>
                    <li>Factures T√©l√©com (Tunisie T√©l√©com, Ooredoo, etc.)</li>
                    <li>Factures STEG (√©lectricit√©, gaz)</li>
                    <li>Factures SONEDE (eau)</li>
                    <li>Entretiens et r√©parations (Personne Morale ou Physique)</li>
                    <li>Timbrage</li>
                    <li>Enregistrement</li>
                    <li>Autres d√©penses</li>
                </ul>
                <p><strong>Moyen de paiement:</strong> <span class="badge badge-virement">Virement</span> uniquement</p>
            </div>

            <h3>4.1 Flux de Paiement - D√©penses Agence</h3>

            <div class="flow-diagram">
                <div class="flow-step">
                    <h5>1. PEC D√©penses Agence</h5>
                    <p><strong>Contr√¥leur nouveau:</strong> ReglementDepensesAgenceCtr.java</p>
                    <p><strong>Saisie:</strong></p>
                    <ul>
                        <li>Choix nature d√©pense (T√©l√©com/STEG/SONEDE/Entretiens/etc.)</li>
                        <li>Si Entretiens: Choix Personne Morale ou Physique</li>
                        <li>CIN/Matricule fiscal b√©n√©ficiaire</li>
                        <li>Si client BNA: Affichage signal√©tique + choix compte</li>
                        <li>Si non client BNA: Saisie coordonn√©es (Adresse, T√©l, RIB, Domiciliation)</li>
                        <li>Num√©ro facture</li>
                        <li>Date r√®glement et date facture</li>
                        <li>Montant Brut</li>
                        <li>Calculs automatiques selon nature b√©n√©ficiaire</li>
                        <li>Upload/Joindre facture PDF</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>2. Validation D√©penses Agence</h5>
                    <p><strong>Action:</strong> Choix validation ou annulation</p>
                    <p><strong>Si validation et RIB BNA:</strong></p>
                    <ul>
                        <li>Appel <strong>PecVirementCompteACompteCtr.java</strong></li>
                        <li>Compte d√©biteur = Compte agence (compte de charges)</li>
                        <li>Compte cr√©diteur = RIB fournisseur</li>
                        <li>Montant = Montant √† r√©gler</li>
                    </ul>
                    <p><strong>Si RIB autre banque:</strong></p>
                    <ul>
                        <li>Cr√©ation GlobalVirement via SaveGlobalVirementTrt.java</li>
                        <li>Ajout au fichier t√©l√©-compensable</li>
                        <li>Envoi tr√©sorerie</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>3. Ex√©cution Virement</h5>
                    <p><strong>Selon type destination:</strong></p>
                    <ul>
                        <li><strong>BNA:</strong> Ex√©cution imm√©diate compte √† compte</li>
                        <li><strong>Autre banque:</strong> G√©n√©ration fichier SIBTEL + compensation</li>
                    </ul>
                    <p><strong>Mise √† jour:</strong> √âtat d√©pense = REGLEE</p>
                </div>
            </div>

            <h3>4.2 Calculs Financiers - D√©penses Agence</h3>

            <div class="card">
                <h4>Formules de Calcul</h4>

                <div class="formula">
<strong>Taux Retenue √† la Source:</strong><br>
- Facture Personne Physique: 1,5%<br>
- Facture Personne Morale: 1,0%<br>
- Autres (T√©l√©com, STEG, SONEDE): 0%<br>
<br>
Montant TVA = Montant Brut √ó Taux TVA<br>
Montant TTC = Montant Brut + Montant TVA<br>
Retenue √† la source = Montant TTC √ó Taux R/S<br>
TVA d√©ductible = Montant TVA √ó Taux TVA d√©ductible<br>
Retenue sur TVA = Montant TVA √ó Taux R/S TVA (si TTC >= 1000 DT)<br>
<br>
<strong>Montant √† r√©gler = Montant TTC - Retenue √† la source - Retenue sur TVA</strong>
                </div>

                <p style="margin-top: 20px;"><strong>Exemple (page 10 du CDC) - Facture STEG:</strong></p>
                <div class="formula">
Montant Brut = 2 000 DT<br>
TVA = 19%, R/S facture = 0%, TVA d√©ductible = 10%, R/S TVA = 25%<br>
<br>
Montant TVA = 2000 √ó 19% = 380 DT<br>
Montant TTC = 2000 + 380 = 2 380 DT<br>
Retenue √† la source = 2380 √ó 0% = 0 DT<br>
TVA d√©ductible = 380 √ó 10% = 38 DT<br>
Retenue sur TVA = 380 √ó 25% = 95 DT<br>
<br>
<strong>Montant √† r√©gler = 2380 - 0 - 95 = 2 285 DT</strong>
                </div>
            </div>

            <h3>4.3 Particularit√©s D√©penses Agence</h3>

            <div class="alert alert-info">
                <strong>üí° Points Importants:</strong>
                <ul>
                    <li>Le compte √† d√©biter est le <strong>compte de l'agence</strong> (compte de charges), pas un compte client</li>
                    <li>Tra√ßabilit√© renforc√©e: Toutes les factures doivent √™tre jointes</li>
                    <li>Workflow d'approbation: Peut n√©cessiter validation hi√©rarchique (Chef d'agence, DR)</li>
                    <li>Reporting: Les d√©penses doivent √™tre rapport√©es dans les √©tats de gestion</li>
                </ul>
            </div>
        </section>

        <section id="section5">
            <h2>5. Op√©ration 3 : R√®glement Loyer</h2>

            <div class="operation-box">
                <h3>üè† Vue d'Ensemble</h3>
                <p><strong>Objectif:</strong> G√©rer le r√®glement p√©riodique des loyers (agence, direction r√©gionale, logements de fonction)</p>
                <p><strong>Types de loyer:</strong></p>
                <ul>
                    <li>Agence</li>
                    <li>Direction R√©gionale</li>
                    <li>Logement de Fonction Chef d'agence</li>
                    <li>Logement de Fonction DR</li>
                </ul>
                <p><strong>P√©riodicit√©s:</strong> Mensuelle, Trimestrielle, Semestrielle, Annuelle</p>
                <p><strong>Moyen de paiement:</strong> <span class="badge badge-virement">Virement Permanent</span></p>
            </div>

            <h3>5.1 Flux de Paiement - R√®glement Loyer</h3>

            <div class="flow-diagram">
                <div class="flow-step">
                    <h5>1. PEC R√®glement Loyer</h5>
                    <p><strong>Contr√¥leur nouveau:</strong> ReglementLoyerCtr.java</p>
                    <p><strong>Saisie:</strong></p>
                    <ul>
                        <li>Nature b√©n√©ficiaire (Personne Morale/Physique)</li>
                        <li>Nom b√©n√©ficiaire</li>
                        <li>CIN/Matricule fiscal</li>
                        <li>Coordonn√©es: Adresse mail, T√©l, RIB, Domiciliation</li>
                        <li>Nature du loyer: Agence / DR / LF Chef / LF DR</li>
                        <li>Montant initial</li>
                        <li>Date d√©but contrat</li>
                        <li>P√©riodicit√© de paiement: M/T/S/A</li>
                        <li>Majoration: Oui/Non
                            <ul>
                                <li>Si Oui: Saisie montant actualis√© HT</li>
                            </ul>
                        </li>
                        <li>Calculs automatiques: TVA, retenues, montant net</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>2. Validation R√®glement Loyer</h5>
                    <p><strong>Action:</strong> Validation du contrat de loyer</p>
                    <p><strong>Si RIB BNA:</strong></p>
                    <ul>
                        <li>Cr√©ation Virement Permanent via <strong>PecVirementPermanentCtr.java</strong></li>
                        <li>Param√®tres:
                            <div class="formula">
- periodiciteGvir = M/T/S/A<br>
- datFinEch = Calcul√©e selon dur√©e contrat<br>
- montantVirement = Montant net √† payer<br>
- compteDebiteur = Compte agence<br>
- compteCrediteur = RIB propri√©taire
                            </div>
                        </li>
                        <li>G√©n√©ration √©ch√©ancier automatique</li>
                    </ul>
                    <p><strong>Si RIB autre banque:</strong></p>
                    <ul>
                        <li>M√™me processus avec virement permanent inter-banques</li>
                        <li>Chaque √©ch√©ance g√©n√©rera un fichier SIBTEL</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>3. Ex√©cution P√©riodique</h5>
                    <p><strong>Traitement:</strong> TraiterExecutionVirPermanentTrt.java</p>
                    <p><strong>Fonctionnement:</strong></p>
                    <ul>
                        <li>Batch quotidien v√©rifie les √©ch√©ances du jour</li>
                        <li>Pour chaque √©ch√©ance √† payer:
                            <ul>
                                <li>V√©rification provision compte agence</li>
                                <li>D√©bit compte agence</li>
                                <li>Cr√©dit compte propri√©taire (si BNA) ou g√©n√©ration fichier</li>
                                <li>G√©n√©ration CRO 716 (Ex√©cution virement permanent)</li>
                            </ul>
                        </li>
                        <li>Gestion des √©ch√©ances futures selon p√©riodicit√©</li>
                        <li>Application des majorations si configur√©es</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>4. Gestion du Contrat</h5>
                    <p><strong>Modifications possibles:</strong></p>
                    <ul>
                        <li><strong>ModifierOrdreVirementPermanentTrt:</strong> Changement montant/RIB</li>
                        <li><strong>ModificationEcheanceDetailVirementPermanentTrt:</strong> Report √©ch√©ance</li>
                        <li><strong>ResiliationVirementTrt:</strong> R√©siliation contrat loyer</li>
                        <li><strong>ReactiverGlobalVirementTrt:</strong> R√©activation apr√®s suspension</li>
                    </ul>
                </div>
            </div>

            <h3>5.2 Calculs Financiers - Loyer</h3>

            <div class="card">
                <h4>Formules de Calcul</h4>

                <div class="formula">
Montant TVA = Montant HT √ó Taux TVA<br>
Montant TTC = Montant HT + Montant TVA<br>
<br>
<strong>Si Montant TTC >= 1000 DT:</strong><br>
Retenue sur TVA = Montant TVA √ó Taux R/S TVA<br>
<br>
Retenue √† la source = Montant TTC √ó Taux R/S<br>
TVA d√©ductible = Montant TVA √ó Taux TVA d√©ductible<br>
<br>
<strong>Montant net √† payer = Montant TTC - Retenue sur TVA - Retenue √† la source</strong>
                </div>

                <p style="margin-top: 20px;"><strong>Exemple (page 14 du CDC) - Loyer trimestriel:</strong></p>
                <div class="formula">
Montant initial = 1 100 DT<br>
R√®glement trimestriel<br>
Date d√©but: 01-01-2024<br>
Majoration: 5% annuelle<br>
TVA = 19%, R/S = 3%, TVA d√©ductible = 25%<br>
<br>
Montant TVA = 1100 √ó 19% = 209 DT<br>
Montant TTC = 1100 + 209 = 1 309 DT<br>
Retenue √† la source = 1309 √ó 3% = 39.27 DT<br>
TVA d√©ductible = 209 √ó 10% = 20.9 DT<br>
Retenue sur TVA = 209 √ó 25% = 52.25 DT (car TTC >= 1000)<br>
<br>
<strong>Montant net √† payer = 1309 - 39.27 - 52.25 = 1 217.48 DT</strong>
                </div>
            </div>

            <h3>5.3 Gestion des Majorations</h3>

            <div class="card">
                <h4>Application Automatique des Majorations</h4>
                <p>Le syst√®me doit g√©rer les majorations p√©riodiques du loyer selon le contrat:</p>

                <div class="formula">
<strong>Exemple majoration annuelle 5%:</strong><br>
<br>
Ann√©e 1 (2024): Montant HT = 1 100 DT<br>
Ann√©e 2 (2025): Montant HT = 1 100 √ó 1.05 = 1 155 DT<br>
Ann√©e 3 (2026): Montant HT = 1 155 √ó 1.05 = 1 212.75 DT<br>
...<br>
<br>
<strong>Chaque ann√©e, le montant de base est actualis√© automatiquement</strong>
                </div>

                <p><strong>Impl√©mentation:</strong></p>
                <ul>
                    <li>Stockage taux majoration dans GlobalVirement</li>
                    <li>Batch annuel applique la majoration</li>
                    <li>Mise √† jour automatique des √©ch√©ances futures</li>
                    <li>Historique des majorations conserv√©</li>
                </ul>
            </div>
        </section>

        <section id="section6">
            <h2>6. Flux de Paiement par Moyen</h2>

            <h3>6.1 Synth√®se des Flux Virement Compte √† Compte (BNA)</h3>

            <div class="flow-diagram">
                <div class="flow-step">
                    <h5>Initialisation</h5>
                    <p>Module appelant: ReglementFraisAuxiliairesCtr / ReglementDepensesAgenceCtr / ReglementLoyerCtr</p>
                    <p>D√©tection: RIB commence par "03" (code BNA)</p>
                </div>

                <div class="flow-step">
                    <h5>Appel Module Virement</h5>
                    <div class="code-ref">PecVirementCompteACompteCtr.java</div>
                    <p>Passage param√®tres compte source, compte destination, montant, motif</p>
                </div>

                <div class="flow-step">
                    <h5>Validation et Contr√¥les</h5>
                    <div class="code-ref">ValiderVirementCompteACompteTrt.java</div>
                    <ul>
                        <li>V√©rification provision compte source</li>
                        <li>V√©rification validit√© compte destination</li>
                        <li>V√©rification RIB format</li>
                        <li>Contr√¥les doublons (24h)</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>Ex√©cution Transaction</h5>
                    <div class="code-ref">InsertionOperationMoyPaySansCROTrt.java</div>
                    <ul>
                        <li>Cr√©ation OperationMoyPay d√©bit (compte source)</li>
                        <li>Cr√©ation OperationMoyPay cr√©dit (compte destination)</li>
                        <li>Mise √† jour soldes</li>
                        <li>Transaction atomique</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>G√©n√©ration CRO</h5>
                    <p>CRO compte √† compte avec d√©tails op√©ration</p>
                    <p>Tra√ßabilit√© compl√®te dans TRACE_VIREMENT</p>
                </div>

                <div class="flow-step">
                    <h5>Confirmation</h5>
                    <p>Retour au module appelant</p>
                    <p>Mise √† jour √©tat: REGLE</p>
                    <p>Notification b√©n√©ficiaire (optionnel)</p>
                </div>
            </div>

            <h3>6.2 Synth√®se des Flux Virement Inter-Banques</h3>

            <div class="flow-diagram">
                <div class="flow-step">
                    <h5>Initialisation</h5>
                    <p>D√©tection: RIB ne commence pas par "03"</p>
                    <p>Cr√©ation ordre de virement</p>
                </div>

                <div class="flow-step">
                    <h5>Cr√©ation GlobalVirement</h5>
                    <div class="code-ref">SaveGlobalVirementTrt.java</div>
                    <ul>
                        <li>G√©n√©ration num√©ro remise unique</li>
                        <li>Type produit = Virement Ponctuel (1063)</li>
                        <li>Cr√©ation GlobalVirement</li>
                        <li>Cr√©ation DetailVirement pour b√©n√©ficiaire</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>Ex√©cution D√©bit</h5>
                    <div class="code-ref">ExecutionDoVirPonctuelTrt.java</div>
                    <ul>
                        <li>Classification destination (AUTRE_BANQUE_ADT ou SGMT)</li>
                        <li>D√©bit compte source</li>
                        <li>G√©n√©ration CRO 715 (Ex√©cution DO)</li>
                        <li>G√©n√©ration CRO 721 (Envoi virement)</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>G√©n√©ration Fichier SIBTEL</h5>
                    <div class="code-ref">CreationFichierVirementTrt.java</div>
                    <ul>
                        <li>Format fichier t√©l√©-compensable SIBTEL</li>
                        <li>Informations: RIB √©metteur, RIB b√©n√©ficiaire, montant, motif</li>
                        <li>Consolidation avec autres virements du jour</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>Envoi Tr√©sorerie</h5>
                    <ul>
                        <li>Envoi fichier SIBTEL via FTP/SFTP s√©curis√©</li>
                        <li>Tr√©sorerie transmet √† BCT</li>
                        <li>Compensation interbancaire (J+1 ou J+2)</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>Cr√©dit B√©n√©ficiaire</h5>
                    <p>Effectu√© par la banque du b√©n√©ficiaire apr√®s compensation</p>
                    <p>D√©lai: 1 √† 2 jours ouvr√©s</p>
                </div>
            </div>

            <h3>6.3 Synth√®se des Flux Ch√®que BCT</h3>

            <div class="flow-diagram">
                <div class="flow-step">
                    <h5>Demande Agence</h5>
                    <p>Module: ReglementFraisAuxiliairesCtr</p>
                    <p>Choix moyen: Ch√®que BCT</p>
                    <p>Validation et d√©bit compte client</p>
                </div>

                <div class="flow-step">
                    <h5>Transmission Tr√©sorerie</h5>
                    <p>Envoi demande avec:</p>
                    <ul>
                        <li>Identit√© b√©n√©ficiaire</li>
                        <li>Montant</li>
                        <li>Motif</li>
                        <li>RIB (si disponible)</li>
                        <li>R√©f√©rence dossier</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>Traitement Tr√©sorerie - Module IBS</h5>
                    <div class="code-ref">GestionFondsDinarIBSCtr.java</div>
                    <ul>
                        <li>R√©ception demande</li>
                        <li>Validation fonds disponibles</li>
                        <li>√âtablissement ch√®que BCT physique</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>√âmission Ch√®que</h5>
                    <div class="code-ref">Cro2230EmissionChequeBCTAchatBBEEmisTrt.java</div>
                    <ul>
                        <li>G√©n√©ration CRO 2230</li>
                        <li>Impression ch√®que s√©curis√©</li>
                        <li>Enregistrement dans syst√®me IBS</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>Retrait et Remise</h5>
                    <div class="code-ref">Cro2212RetraitChequeIBSEmisTrt.java</div>
                    <ul>
                        <li>Notification agence que ch√®que est pr√™t</li>
                        <li>Retrait par agence ou envoi s√©curis√©</li>
                        <li>Remise au b√©n√©ficiaire</li>
                        <li>Signature d√©charge</li>
                        <li>G√©n√©ration CRO 2212</li>
                    </ul>
                </div>

                <div class="flow-step">
                    <h5>Encaissement B√©n√©ficiaire</h5>
                    <p>Le b√©n√©ficiaire pr√©sente le ch√®que BCT dans sa banque</p>
                    <p>Cr√©dit imm√©diat (garantie BCT)</p>
                </div>
            </div>
        </section>

        <section id="section7">
            <h2>7. Int√©gration avec l'Existant SMILE</h2>

            <h3>7.1 Modules √† R√©utiliser</h3>

            <table>
                <thead>
                    <tr>
                        <th>Module SMILE</th>
                        <th>Chemin</th>
                        <th>Utilisation CDC</th>
                        <th>Adaptation N√©cessaire</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Virement Compte √† Compte</strong></td>
                        <td>web/virement/controller/PecVirementCompteACompteCtr.java</td>
                        <td>Toutes op√©rations BNA‚ÜíBNA</td>
                        <td><span class="badge badge-warning">Mineure</span> - Interface d'appel</td>
                    </tr>
                    <tr>
                        <td><strong>Virement Ponctuel</strong></td>
                        <td>web/virement/controller/PecVirementPonctuelCtr.java</td>
                        <td>Virements inter-banques</td>
                        <td><span class="badge badge-warning">Mineure</span> - Param√©trage</td>
                    </tr>
                    <tr>
                        <td><strong>Virement Permanent</strong></td>
                        <td>web/virement/controller/PecVirementPermanentCtr.java</td>
                        <td>R√®glement loyer p√©riodique</td>
                        <td><span class="badge badge-warning">Moyenne</span> - Gestion majorations</td>
                    </tr>
                    <tr>
                        <td><strong>Traitement Ex√©cution</strong></td>
                        <td>model/virement/traitement/ExecutionDoVirPonctuelTrt.java</td>
                        <td>Ex√©cution tous virements</td>
                        <td><span class="badge badge-virement">Aucune</span> - R√©utilisation directe</td>
                    </tr>
                    <tr>
                        <td><strong>Cr√©ation Fichier SIBTEL</strong></td>
                        <td>model/virement/traitement/CreationFichierVirementTrt.java</td>
                        <td>Fichier t√©l√©-compensable</td>
                        <td><span class="badge badge-virement">Aucune</span> - R√©utilisation directe</td>
                    </tr>
                    <tr>
                        <td><strong>Module IBS</strong></td>
                        <td>web/IBS/controller/GestionFondsDinarIBSCtr.java</td>
                        <td>Ch√®que BCT</td>
                        <td><span class="badge badge-warning">Moyenne</span> - Workflow int√©gration</td>
                    </tr>
                    <tr>
                        <td><strong>Op√©ration Comptable</strong></td>
                        <td>model/commun/traitement/InsertionOperationMoyPaySansCROTrt.java</td>
                        <td>D√©bits/Cr√©dits comptes</td>
                        <td><span class="badge badge-virement">Aucune</span> - R√©utilisation directe</td>
                    </tr>
                </tbody>
            </table>

            <h3>7.2 Nouveaux Composants √† D√©velopper</h3>

            <div class="grid-2col">
                <div class="card">
                    <h4>üÜï Contr√¥leurs</h4>
                    <ul>
                        <li><strong>ReglementFraisAuxiliairesCtr.java</strong>
                            <ul>
                                <li>PEC frais auxiliaires</li>
                                <li>Modification PEC</li>
                                <li>Annulation PEC</li>
                                <li>Validation avec choix moyen paiement</li>
                            </ul>
                        </li>
                        <li><strong>ReglementDepensesAgenceCtr.java</strong>
                            <ul>
                                <li>PEC d√©penses agence</li>
                                <li>Annulation PEC</li>
                                <li>Validation d√©penses</li>
                            </ul>
                        </li>
                        <li><strong>ReglementLoyerCtr.java</strong>
                            <ul>
                                <li>PEC r√®glement loyer</li>
                                <li>Annulation PEC</li>
                                <li>Validation r√®glement loyer</li>
                                <li>Gestion majorations</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="card">
                    <h4>üÜï Entit√©s et Mod√®les</h4>
                    <ul>
                        <li><strong>FraisAuxiliaire.java</strong>
                            <ul>
                                <li>Type auxiliaire</li>
                                <li>Nature (conventionn√©/non)</li>
                                <li>Montants et calculs</li>
                                <li>Moyen paiement choisi</li>
                                <li>√âtat (PEC/VALID√â/R√âGL√â)</li>
                            </ul>
                        </li>
                        <li><strong>DepenseAgence.java</strong>
                            <ul>
                                <li>Nature d√©pense</li>
                                <li>B√©n√©ficiaire</li>
                                <li>Facture (r√©f√©rence + fichier)</li>
                                <li>Montants et calculs</li>
                                <li>√âtat</li>
                            </ul>
                        </li>
                        <li><strong>ContratLoyer.java</strong>
                            <ul>
                                <li>Nature loyer</li>
                                <li>B√©n√©ficiaire</li>
                                <li>Montant initial</li>
                                <li>P√©riodicit√©</li>
                                <li>Majoration</li>
                                <li>Lien GlobalVirement permanent</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>

            <h3>7.3 Architecture d'Int√©gration</h3>

            <div class="code-ref">Proposition d'Architecture</div>

            <pre style="background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto;">
smile/
‚îú‚îÄ‚îÄ web/
‚îÇ   ‚îî‚îÄ‚îÄ reglementFrais/
‚îÇ       ‚îú‚îÄ‚îÄ controller/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ ReglementFraisAuxiliairesCtr.java
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ ReglementDepensesAgenceCtr.java
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ ReglementLoyerCtr.java
‚îÇ       ‚îú‚îÄ‚îÄ forms/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ FraisAuxiliaireForm.java
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ DepenseAgenceForm.java
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ ContratLoyerForm.java
‚îÇ       ‚îî‚îÄ‚îÄ validator/
‚îÇ           ‚îú‚îÄ‚îÄ FraisAuxiliaireValidator.java
‚îÇ           ‚îú‚îÄ‚îÄ DepenseAgenceValidator.java
‚îÇ           ‚îî‚îÄ‚îÄ ContratLoyerValidator.java
‚îÇ
‚îî‚îÄ‚îÄ model/
    ‚îî‚îÄ‚îÄ reglementFrais/
        ‚îú‚îÄ‚îÄ traitement/
        ‚îÇ   ‚îú‚îÄ‚îÄ ValidationFraisAuxiliairesTrt.java
        ‚îÇ   ‚îú‚îÄ‚îÄ ValidationDepensesAgenceTrt.java
        ‚îÇ   ‚îú‚îÄ‚îÄ ValidationReglementLoyerTrt.java
        ‚îÇ   ‚îî‚îÄ‚îÄ CalculMontantsReglementTrt.java
        ‚îú‚îÄ‚îÄ commande/
        ‚îÇ   ‚îú‚îÄ‚îÄ PecFraisAuxiliairesCmd.java
        ‚îÇ   ‚îú‚îÄ‚îÄ PecDepenseAgenceCmd.java
        ‚îÇ   ‚îî‚îÄ‚îÄ PecContratLoyerCmd.java
        ‚îî‚îÄ‚îÄ dao/
            ‚îî‚îÄ‚îÄ ReglementFraisDAO.java

<strong>Entit√©s (r√©utilisation mod√®le commun):</strong>
commun/model/
‚îú‚îÄ‚îÄ FraisAuxiliaire.java
‚îú‚îÄ‚îÄ DepenseAgence.java
‚îî‚îÄ‚îÄ ContratLoyer.java
            </pre>
        </section>

        <section id="section8">
            <h2>8. Sch√©mas Comptables et CRO</h2>

            <h3>8.1 CRO Virement (R√©utilis√©s)</h3>

            <table>
                <thead>
                    <tr>
                        <th>Code CRO</th>
                        <th>Op√©ration</th>
                        <th>Fichier Traitement</th>
                        <th>Usage CDC</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>715</strong></td>
                        <td>Ex√©cution Virement Ponctuel DO</td>
                        <td>CreationCROExecutionVirementPonctuelTrt.java</td>
                        <td>Virement inter-banques (d√©bit)</td>
                    </tr>
                    <tr>
                        <td><strong>716</strong></td>
                        <td>Ex√©cution Virement Permanent</td>
                        <td>CreationCROExecutionVirementPermanentTrt.java</td>
                        <td>R√®glement loyer p√©riodique</td>
                    </tr>
                    <tr>
                        <td><strong>721</strong></td>
                        <td>Envoi Virement</td>
                        <td>CreationCROEnvoiVirementTrt.java</td>
                        <td>Envoi fichier SIBTEL</td>
                    </tr>
                    <tr>
                        <td><strong>822</strong></td>
                        <td>Position Virement B√©n√©ficiaire</td>
                        <td>CreationCROPositionVirementTrt.java</td>
                        <td>Cr√©dit compte b√©n√©ficiaire BNA</td>
                    </tr>
                    <tr>
                        <td><strong>823</strong></td>
                        <td>Rejet Virement</td>
                        <td>CreationCRORejetVirementTrt.java</td>
                        <td>Rejet et remboursement</td>
                    </tr>
                </tbody>
            </table>

            <h3>8.2 CRO Ch√®que BCT (Module IBS)</h3>

            <table>
                <thead>
                    <tr>
                        <th>Code CRO</th>
                        <th>Op√©ration</th>
                        <th>Fichier Traitement</th>
                        <th>Usage CDC</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>2230</strong></td>
                        <td>√âmission Ch√®que BCT</td>
                        <td>Cro2230EmissionChequeBCTAchatBBEEmisTrt.java</td>
                        <td>√âtablissement ch√®que BCT</td>
                    </tr>
                    <tr>
                        <td><strong>2212</strong></td>
                        <td>Retrait Ch√®que IBS</td>
                        <td>Cro2212RetraitChequeIBSEmisTrt.java</td>
                        <td>Remise ch√®que au b√©n√©ficiaire</td>
                    </tr>
                </tbody>
            </table>

            <h3>8.3 Sch√©mas Comptables</h3>

            <div class="card">
                <h4>1. R√®glement Frais Auxiliaires (Virement BNA)</h4>
                <div class="formula">
<strong>D√©bit:</strong> Compte Client (montant √† servir)<br>
<strong>Cr√©dit:</strong> Compte Auxiliaire (montant √† servir)<br>
<br>
<strong>Enregistrements parall√®les (√âtat):</strong><br>
- Compte Retenue √† la Source: Retenue R/S<br>
- Compte Retenue sur TVA: Retenue TVA (si applicable)<br>
- Compte TVA d√©ductible: Montant TVA d√©ductible
                </div>
            </div>

            <div class="card" style="margin-top: 20px;">
                <h4>2. R√®glement D√©penses Agence (Virement BNA)</h4>
                <div class="formula">
<strong>D√©bit:</strong> Compte Charges Agence (montant √† r√©gler)<br>
<strong>Cr√©dit:</strong> Compte Fournisseur (montant √† r√©gler)<br>
<br>
<strong>Enregistrements parall√®les:</strong><br>
- Compte Retenue √† la Source Fournisseur: Retenue<br>
- Compte TVA d√©ductible: Montant TVA d√©ductible
                </div>
            </div>

            <div class="card" style="margin-top: 20px;">
                <h4>3. R√®glement Loyer (Virement Permanent BNA)</h4>
                <div class="formula">
<strong>√Ä chaque √©ch√©ance:</strong><br>
<br>
<strong>D√©bit:</strong> Compte Charges Loyer Agence (montant net)<br>
<strong>Cr√©dit:</strong> Compte Propri√©taire (montant net)<br>
<br>
<strong>Enregistrements parall√®les:</strong><br>
- Compte Retenue Loyer: Montant R/S<br>
- Compte Retenue sur TVA: Montant R/S TVA
                </div>
            </div>

            <div class="card" style="margin-top: 20px;">
                <h4>4. R√®glement par Ch√®que BCT</h4>
                <div class="formula">
<strong>√Ä l'√©mission (CRO 2230):</strong><br>
<br>
<strong>D√©bit:</strong> Compte Client/Agence (montant ch√®que)<br>
<strong>Cr√©dit:</strong> Compte Transit Ch√®ques BCT (montant ch√®que)<br>
<br>
<strong>√Ä l'encaissement:</strong><br>
<br>
<strong>D√©bit:</strong> Compte Transit Ch√®ques BCT<br>
<strong>Cr√©dit:</strong> Compte Compensation BCT
                </div>
            </div>

            <h3>8.4 √âtats et Tra√ßabilit√©</h3>

            <table>
                <thead>
                    <tr>
                        <th>Op√©ration</th>
                        <th>√âtat Initial</th>
                        <th>√âtat Validation</th>
                        <th>√âtat Final</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Frais Auxiliaires</td>
                        <td>PEC</td>
                        <td>VALID√â</td>
                        <td>R√âGL√â</td>
                    </tr>
                    <tr>
                        <td>D√©pense Agence</td>
                        <td>PEC</td>
                        <td>VALID√â</td>
                        <td>R√âGL√âE</td>
                    </tr>
                    <tr>
                        <td>Contrat Loyer</td>
                        <td>PEC</td>
                        <td>ACTIF</td>
                        <td>EN COURS / R√âSILI√â</td>
                    </tr>
                    <tr>
                        <td>√âch√©ance Loyer</td>
                        <td>√Ä PAYER</td>
                        <td>-</td>
                        <td>PAY√âE</td>
                    </tr>
                </tbody>
            </table>

            <div class="alert alert-success" style="margin-top: 30px;">
                <h4>‚úÖ Conformit√© CDC - Sch√©mas Comptables</h4>
                <p><strong>Selon le cahier de charges:</strong></p>
                <ul>
                    <li><strong>Op√©ration 1 (Frais Auxiliaires):</strong>
                        <ul>
                            <li>PEC: Sch√©ma comptable = <strong>N√©ant</strong></li>
                            <li>Validation: Sch√©ma comptable = <strong>OUI</strong> ‚úì</li>
                        </ul>
                    </li>
                    <li><strong>Op√©ration 2 (D√©penses Agence):</strong>
                        <ul>
                            <li>PEC: Sch√©ma comptable = <strong>N√©ant</strong></li>
                            <li>Validation: Sch√©ma comptable = <strong>OUI</strong> ‚úì</li>
                        </ul>
                    </li>
                    <li><strong>Op√©ration 3 (Loyer):</strong>
                        <ul>
                            <li>PEC: Sch√©ma comptable = <strong>N√©ant</strong></li>
                            <li>Validation: Sch√©ma comptable = <strong>OUI</strong> ‚úì</li>
                        </ul>
                    </li>
                </ul>
                <p style="margin-top: 15px;">Les sch√©mas comptables sont g√©n√©r√©s uniquement lors de la validation, conform√©ment au CDC. Les CRO de virement existants dans SMILE permettent cette tra√ßabilit√©.</p>
            </div>
        </section>

        <footer>
            <p>&copy; 2026 BNA - Syst√®me SMILE</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Documentation g√©n√©r√©e pour le projet "R√®glement Frais Au Niveau De L'Agence"</p>
            <p style="font-size: 0.8em; margin-top: 5px;">Version 1.0 - Janvier 2025</p>
        </footer>
    </div>
</body>
</html>